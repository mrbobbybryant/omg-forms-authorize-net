!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=0)}([function(e,t,n){"use strict";var r=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r);document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".omg-form-wrapper");e&&[].forEach.call(e,function(e){-1!==JSON.parse(e.dataset.formtype).indexOf("authorize_net")&&(0,a.default)(e.querySelector("form"))})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(e,t,n){if(!1===t&&""==!n.target.value){var a=r.querySelector(".omg-error");e.parentNode.classList.add("error"),a.innerHTML="This card number is not valid"}else""!=n.target.value&&!0!==t||e.parentNode.classList.remove("error")}function n(){var e=l.value,t=c.value,n=a.default.validateCardExpiry(e,t);!1===n&&""==!e&&""==!t?(o.classList.add("error"),i.classList.add("error")):(!0===n||""==e&&""==t)&&(o.classList.remove("error"),i.classList.remove("error"))}if(!e)return!1;var r=document.getElementById("omg-forms-card_number"),u=r.querySelector("input"),o=document.getElementById("omg-forms-expiration_month"),l=void 0;o&&(l=o.querySelector("select"));var i=document.getElementById("omg-forms-expiration_year"),c=void 0;i&&(c=i.querySelector("select"));var d=document.getElementById("omg-forms-card_code"),s=d.querySelector("input"),f=document.getElementById("omg-forms-expiration_date"),g=void 0;f&&(g=f.querySelector("input")),a.default.cardNumberInput(u),a.default.cvcInput(s),u.addEventListener("keyup",function(e){r.classList.contains("error")&&t(u,a.default.validateCardNumber(e.target.value),e)}),s.addEventListener("keyup",function(e){d.classList.contains("error")&&t(s,a.default.validateCardCVC(e.target.value),e)}),u.addEventListener("blur",function(){t(u,a.default.validateCardNumber(event.target.value),event)}),s.addEventListener("blur",function(){t(s,a.default.validateCardCVC(event.target.value),event)}),f&&(g.addEventListener("keyup",function(e){d.classList.contains("error")&&t(s,a.default.validateCardCVC(e.target.value),e)}),g.addEventListener("blur",function(){t(u,a.default.validateCardNumber(event.target.value),event)})),o&&l.addEventListener("change",function(){n()}),i&&c.addEventListener("change",function(){n()})};var r=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){(function(e){(function(){var t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};!function(t,r){void 0!==e&&null!==e?e.exports=r():n(4)("payform",r)}(0,function(){var e,n,r,a,u,o,l,i,c,d,s,f,g,v,h,p,m,y,C,L,b,S,E;return n=function(e){var t,n,r;return null!=e.selectionStart?e.selectionStart:null!=document.selection?(e.focus(),t=document.selection.createRange(),r=e.createTextRange(),n=r.duplicate(),r.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",r),n.text.length):void 0},e=function(e){return function(t){return null==t&&(t=window.event),t.target=t.target||t.srcElement,t.which=t.which||t.keyCode,null==t.preventDefault&&(t.preventDefault=function(){return this.returnValue=!1}),e(t)}},r=function(t,n,r){return r=e(r),null!=t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent("on"+n,r)},h={},o=/(\d{1,4})/g,h.cards=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:o,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:o,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^(5[1-5]|2[2-7])/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:/(\d{1,4})(\d{1,4})?(\d{1,4})?(\d{1,2})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:o,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:o,length:[16],cvcLength:[3],luhn:!0}],a=function(e){var t,n,r,a;for(e=(e+"").replace(/\D/g,""),a=h.cards,n=0,r=a.length;n<r;n++)if(t=a[n],t.pattern.test(e))return t},u=function(e){var t,n,r,a;for(a=h.cards,n=0,r=a.length;n<r;n++)if(t=a[n],t.type===e)return t},v=function(e){var t,n,r,a,u,o;for(u=!0,o=0,n=(e+"").split("").reverse(),r=0,a=n.length;r<a;r++)t=n[r],t=parseInt(t,10),(u=!u)&&(t*=2),t>9&&(t-=9),o+=t;return o%10==0},g=function(e){var t;return!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)||null!=e.selectionStart&&e.selectionStart!==e.selectionEnd},C=function(e){var t,n,r,a,u,o,l,i;for(null==e&&(e=""),r="０１２３４５６７８９",a="0123456789",i="",n=e.split(""),u=0,l=n.length;u<l;u++)t=n[u],o=r.indexOf(t),o>-1&&(t=a[o]),i+=t;return i},m=function(e){var t;if(t=n(e.target),e.target.value=h.formatCardNumber(e.target.value),null!=t&&"change"!==e.type)return e.target.setSelectionRange(t,t)},d=function(e){var t,r,u,o,l,i,c;if(u=String.fromCharCode(e.which),/^\d+$/.test(u)&&(c=e.target.value,t=a(c+u),o=(c.replace(/\D/g,"")+u).length,i=16,t&&(i=t.length[t.length.length-1]),!(o>=i||(r=n(e.target))&&r!==c.length)))return l=t&&"amex"===t.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,l.test(c)?(e.preventDefault(),setTimeout(function(){return e.target.value=c+" "+u})):l.test(c+u)?(e.preventDefault(),setTimeout(function(){return e.target.value=c+u+" "})):void 0},l=function(e){var t,r;if(r=e.target.value,8===e.which&&(!(t=n(e.target))||t===r.length))return/\d\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return e.target.value=r.replace(/\d\s$/,"")})):/\s\d?$/.test(r)?(e.preventDefault(),setTimeout(function(){return e.target.value=r.replace(/\d$/,"")})):void 0},y=function(e){var t;if(t=n(e.target),e.target.value=h.formatCardExpiry(e.target.value),null!=t&&"change"!==e.type)return e.target.setSelectionRange(t,t)},c=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target.value+t,/^\d$/.test(n)&&"0"!==n&&"1"!==n?(e.preventDefault(),setTimeout(function(){return e.target.value="0"+n+" / "})):/^\d\d$/.test(n)?(e.preventDefault(),setTimeout(function(){return e.target.value=n+" / "})):void 0},s=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target.value,/^\d\d$/.test(n)?e.target.value=n+" / ":void 0},f=function(e){var t,n;if("/"===(n=String.fromCharCode(e.which))||" "===n)return t=e.target.value,/^\d$/.test(t)&&"0"!==t?e.target.value="0"+t+" / ":void 0},i=function(e){var t,r;if(r=e.target.value,8===e.which&&(!(t=n(e.target))||t===r.length))return/\d\s\/\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return e.target.value=r.replace(/\d\s\/\s$/,"")})):void 0},p=function(e){var t;if(t=n(e.target),e.target.value=C(e.target.value).replace(/\D/g,"").slice(0,4),null!=t&&"change"!==e.type)return e.target.setSelectionRange(t,t)},E=function(e){var t;if(!(e.metaKey||e.ctrlKey||0===e.which||e.which<33))return t=String.fromCharCode(e.which),/^\d+$/.test(t)?void 0:e.preventDefault()},b=function(e){var t,n,r;if(n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!g(e.target))return r=(e.target.value+n).replace(/\D/g,""),t=a(r),t&&r.length>t.length[t.length.length-1]?e.preventDefault():r.length>16?e.preventDefault():void 0},S=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t)&&!g(e.target))return n=e.target.value+t,n=n.replace(/\D/g,""),n.length>6?e.preventDefault():void 0},L=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t)&&!g(e.target))return n=e.target.value+t,n.length>4?e.preventDefault():void 0},h.cvcInput=function(e){return r(e,"keypress",E),r(e,"keypress",L),r(e,"paste",p),r(e,"change",p),r(e,"input",p)},h.expiryInput=function(e){return r(e,"keypress",E),r(e,"keypress",S),r(e,"keypress",c),r(e,"keypress",f),r(e,"keypress",s),r(e,"keydown",i),r(e,"change",y),r(e,"input",y)},h.cardNumberInput=function(e){return r(e,"keypress",E),r(e,"keypress",b),r(e,"keypress",d),r(e,"keydown",l),r(e,"paste",m),r(e,"change",m),r(e,"input",m)},h.numericInput=function(e){return r(e,"keypress",E),r(e,"paste",E),r(e,"change",E),r(e,"input",E)},h.parseCardExpiry=function(e){var t,n,r,a;return e=e.replace(/\s/g,""),r=e.split("/",2),t=r[0],a=r[1],2===(null!=a?a.length:void 0)&&/^\d+$/.test(a)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),a=n+a),t=parseInt(t,10),a=parseInt(a,10),{month:t,year:a}},h.validateCardNumber=function(e){var n,r;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(n=a(e))&&(r=e.length,t.call(n.length,r)>=0&&(!1===n.luhn||v(e))))},h.validateCardExpiry=function(e,t){var n,r,a;return"object"==typeof e&&"month"in e&&(a=e,e=a.month,t=a.year),!(!e||!t)&&(e=String(e).trim(),t=String(t).trim(),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(1<=e&&e<=12&&(2===t.length&&(t=t<70?"20"+t:"19"+t),4===t.length&&(r=new Date(t,e),n=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),r>n)))))},h.validateCardCVC=function(e,n){var r,a;return e=String(e).trim(),!!/^\d+$/.test(e)&&(r=u(n),null!=r?(a=e.length,t.call(r.cvcLength,a)>=0):e.length>=3&&e.length<=4)},h.parseCardType=function(e){var t;return e?(null!=(t=a(e))?t.type:void 0)||null:null},h.formatCardNumber=function(e){var t,n,r,u;return e=C(e),e=e.replace(/\D/g,""),(t=a(e))?(u=t.length[t.length.length-1],e=e.slice(0,u),t.format.global?null!=(r=e.match(t.format))?r.join(" "):void 0:null!=(n=t.format.exec(e))?(n.shift(),n=n.filter(Boolean),n.join(" ")):void 0):e},h.formatCardExpiry=function(e){var t,n,r,a;return e=C(e),(n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",r=n[2]||"",a=n[3]||"",a.length>0?r=" / ":" /"===r?(t=t.substring(0,1),r=""):2===t.length||r.length>0?r=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,r=" / "),t+r+a):""},h})}).call(this)}).call(t,n(3)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXguYnVuZGxlLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA4ZTc4ZGVmYTQ4MWI2YzhkNjdhOCIsIndlYnBhY2s6Ly8vLi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9jYXJkLXZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy9Vc2Vycy9ib2JieS9TaXRlcy9oZWxwaW5naGFuZHMvaHRkb2NzL3dwLWNvbnRlbnQvdGhlbWVzL2hlbHBpbmdoYW5kcy92ZW5kb3IvZGV2ZWxvcHdpdGh3cC9vbWctZm9ybXMtYXV0aG9yaXplLW5ldC9ub2RlX21vZHVsZXMvcGF5Zm9ybS9kaXN0L3BheWZvcm0uanMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vYW1kLWRlZmluZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX2NhcmRWYWxpZGF0aW9uIiwiX2NhcmRWYWxpZGF0aW9uMiIsIm9iaiIsImRlZmF1bHQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJmb3JtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZm9ybVdyYXBwZXIiLCJKU09OIiwicGFyc2UiLCJkYXRhc2V0IiwiZm9ybXR5cGUiLCJpbmRleE9mIiwicXVlcnlTZWxlY3RvciIsInZhbHVlIiwiZm9ybSIsInZhbGlkYXRlQ2FyZElucHV0IiwiZWxlbWVudCIsInZhbGlkIiwiZXZlbnQiLCJ0YXJnZXQiLCJlcnJvck1lc3NhZ2UiLCJjYXJkRmllbGQiLCJwYXJlbnROb2RlIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwicmVtb3ZlIiwidmFsaWRhdGVDYXJkRGF0ZSIsIm1vbnRoIiwiY2FyZE1vbnRoU2VsZWN0IiwieWVhciIsImNhcmRZZWFyU2VsZWN0IiwidmFsaWRDYXJkRGF0ZSIsIl9wYXlmb3JtMiIsInZhbGlkYXRlQ2FyZEV4cGlyeSIsImNhcmRNb250aCIsImNhcmRZZWFyIiwiZ2V0RWxlbWVudEJ5SWQiLCJjYXJkSW5wdXQiLCJjYXJkQ29kZSIsImNhcmRDb2RlSW5wdXQiLCJjYXJkRXhwaXJhdGlvbiIsImNhcmRFeHBpcmF0aW9uSW5wdXQiLCJjYXJkTnVtYmVySW5wdXQiLCJjdmNJbnB1dCIsImNvbnRhaW5zIiwidmFsaWRhdGVDYXJkTnVtYmVyIiwidmFsaWRhdGVDYXJkQ1ZDIiwiX3BheWZvcm0iLCJpdGVtIiwidGhpcyIsImxlbmd0aCIsImRlZmluaXRpb24iLCJfZXZlbnROb3JtYWxpemUiLCJfZ2V0Q2FyZXRQb3MiLCJfb24iLCJjYXJkRnJvbU51bWJlciIsImNhcmRGcm9tVHlwZSIsImRlZmF1bHRGb3JtYXQiLCJmb3JtYXRCYWNrQ2FyZE51bWJlciIsImZvcm1hdEJhY2tFeHBpcnkiLCJmb3JtYXRDYXJkRXhwaXJ5IiwiZm9ybWF0Q2FyZE51bWJlciIsImZvcm1hdEZvcndhcmRFeHBpcnkiLCJmb3JtYXRGb3J3YXJkU2xhc2hBbmRTcGFjZSIsImhhc1RleHRTZWxlY3RlZCIsImx1aG5DaGVjayIsInBheWZvcm0iLCJyZUZvcm1hdENWQyIsInJlRm9ybWF0Q2FyZE51bWJlciIsInJlRm9ybWF0RXhwaXJ5IiwicmVwbGFjZUZ1bGxXaWR0aENoYXJzIiwicmVzdHJpY3RDVkMiLCJyZXN0cmljdENhcmROdW1iZXIiLCJyZXN0cmljdEV4cGlyeSIsInJlc3RyaWN0TnVtZXJpYyIsImVsZSIsInIiLCJyYyIsInJlIiwic2VsZWN0aW9uU3RhcnQiLCJzZWxlY3Rpb24iLCJmb2N1cyIsImNyZWF0ZVJhbmdlIiwiY3JlYXRlVGV4dFJhbmdlIiwiZHVwbGljYXRlIiwibW92ZVRvQm9va21hcmsiLCJnZXRCb29rbWFyayIsInNldEVuZFBvaW50IiwidGV4dCIsImxpc3RlbmVyIiwiZSIsIndpbmRvdyIsInNyY0VsZW1lbnQiLCJ3aGljaCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInJldHVyblZhbHVlIiwiYXR0YWNoRXZlbnQiLCJjYXJkcyIsInR5cGUiLCJwYXR0ZXJuIiwiZm9ybWF0IiwiY3ZjTGVuZ3RoIiwibHVobiIsIm51bSIsImNhcmQiLCJsZW4iLCJyZWYiLCJyZXBsYWNlIiwidGVzdCIsImRpZ2l0IiwiZGlnaXRzIiwib2RkIiwic3VtIiwic3BsaXQiLCJyZXZlcnNlIiwicGFyc2VJbnQiLCJzZWxlY3Rpb25FbmQiLCJzdHIiLCJjaGFyIiwiY2hhcnMiLCJmdWxsV2lkdGgiLCJoYWxmV2lkdGgiLCJpZHgiLCJjdXJzb3IiLCJzZXRTZWxlY3Rpb25SYW5nZSIsInVwcGVyTGVuZ3RoIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwic2V0VGltZW91dCIsInZhbCIsInNsaWNlIiwiaW5wdXQiLCJtZXRhS2V5IiwiY3RybEtleSIsImV4cGlyeUlucHV0IiwibnVtZXJpY0lucHV0IiwicGFyc2VDYXJkRXhwaXJ5IiwicHJlZml4IiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwidG9TdHJpbmciLCJjdXJyZW50VGltZSIsImV4cGlyeSIsInRyaW0iLCJzZXRNb250aCIsImdldE1vbnRoIiwiY3ZjIiwicGFyc2VDYXJkVHlwZSIsImdyb3VwcyIsImdsb2JhbCIsIm1hdGNoIiwiam9pbiIsImV4ZWMiLCJzaGlmdCIsImZpbHRlciIsIkJvb2xlYW4iLCJtb24iLCJwYXJ0cyIsInNlcCIsInN1YnN0cmluZyIsIndlYnBhY2tQb2x5ZmlsbCIsImRlcHJlY2F0ZSIsInBhdGhzIiwiY2hpbGRyZW4i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LE1BR0MxRixLQUFBeUUsUUprTzRCekUsS0FBS0osRUFBU0gsRUFBb0IsR0FBR0ksS0FJNUQsU0FBVUEsRUFBUUQsR0tyeUJ4QkMsRUFBQUQsUUFBQSxTQUFBQyxHQW9CQSxNQW5CQUEsR0FBQTRMLGtCQUNBNUwsRUFBQTZMLFVBQUEsYUFDQTdMLEVBQUE4TCxTQUVBOUwsRUFBQStMLFdBQUEvTCxFQUFBK0wsYUFDQXJMLE9BQUFDLGVBQUFYLEVBQUEsVUFDQWEsWUFBQSxFQUNBQyxJQUFBLFdBQ0EsTUFBQWQsR0FBQUUsS0FHQVEsT0FBQUMsZUFBQVgsRUFBQSxNQUNBYSxZQUFBLEVBQ0FDLElBQUEsV0FDQSxNQUFBZCxHQUFBQyxLQUdBRCxFQUFBNEwsZ0JBQUEsR0FFQTVMLElMNnlCTSxTQUFVQSxFQUFRRCxHTWowQnhCQyxFQUFBRCxRQUFBLFdBQ0EsU0FBQWlNLE9BQUEiLCJmaWxlIjoiaW5kZXguYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9kaXN0L1wiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgX2NhcmRWYWxpZGF0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIF9jYXJkVmFsaWRhdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jYXJkVmFsaWRhdGlvbik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm9tZy1mb3JtLXdyYXBwZXInKTtcblxuICAgIGlmIChmb3Jtcykge1xuICAgICAgICBbXS5mb3JFYWNoLmNhbGwoZm9ybXMsIGZ1bmN0aW9uIChmb3JtV3JhcHBlcikge1xuICAgICAgICAgICAgdmFyIGZvcm1UeXBlcyA9IEpTT04ucGFyc2UoZm9ybVdyYXBwZXIuZGF0YXNldC5mb3JtdHlwZSk7XG5cbiAgICAgICAgICAgIGlmICgtMSAhPT0gZm9ybVR5cGVzLmluZGV4T2YoJ2F1dGhvcml6ZV9uZXQnKSkge1xuICAgICAgICAgICAgICAgICgwLCBfY2FyZFZhbGlkYXRpb24yLmRlZmF1bHQpKGZvcm1XcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoZm9ybSkge1xuXG4gICAgaWYgKCFmb3JtKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgY2FyZEZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29tZy1mb3Jtcy1jYXJkX251bWJlcicpO1xuICAgIHZhciBjYXJkSW5wdXQgPSBjYXJkRmllbGQucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcblxuICAgIHZhciBjYXJkTW9udGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb21nLWZvcm1zLWV4cGlyYXRpb25fbW9udGgnKTtcbiAgICB2YXIgY2FyZE1vbnRoU2VsZWN0ID0gdm9pZCAwO1xuICAgIGlmIChjYXJkTW9udGgpIHtcbiAgICAgICAgY2FyZE1vbnRoU2VsZWN0ID0gY2FyZE1vbnRoLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuICAgIH1cblxuICAgIHZhciBjYXJkWWVhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtZXhwaXJhdGlvbl95ZWFyJyk7XG4gICAgdmFyIGNhcmRZZWFyU2VsZWN0ID0gdm9pZCAwO1xuICAgIGlmIChjYXJkWWVhcikge1xuICAgICAgICBjYXJkWWVhclNlbGVjdCA9IGNhcmRZZWFyLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuICAgIH1cblxuICAgIHZhciBjYXJkQ29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtY2FyZF9jb2RlJyk7XG4gICAgdmFyIGNhcmRDb2RlSW5wdXQgPSBjYXJkQ29kZS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuXG4gICAgdmFyIGNhcmRFeHBpcmF0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29tZy1mb3Jtcy1leHBpcmF0aW9uX2RhdGUnKTtcbiAgICB2YXIgY2FyZEV4cGlyYXRpb25JbnB1dCA9IHZvaWQgMDtcbiAgICBpZiAoY2FyZEV4cGlyYXRpb24pIHtcbiAgICAgICAgY2FyZEV4cGlyYXRpb25JbnB1dCA9IGNhcmRFeHBpcmF0aW9uLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgfVxuXG4gICAgX3BheWZvcm0yLmRlZmF1bHQuY2FyZE51bWJlcklucHV0KGNhcmRJbnB1dCk7XG4gICAgX3BheWZvcm0yLmRlZmF1bHQuY3ZjSW5wdXQoY2FyZENvZGVJbnB1dCk7XG5cbiAgICBjYXJkSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKGNhcmRGaWVsZC5jbGFzc0xpc3QuY29udGFpbnMoJ2Vycm9yJykpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZElucHV0KGNhcmRJbnB1dCwgX3BheWZvcm0yLmRlZmF1bHQudmFsaWRhdGVDYXJkTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSksIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgY2FyZENvZGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoY2FyZENvZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdlcnJvcicpKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkQ29kZUlucHV0LCBfcGF5Zm9ybTIuZGVmYXVsdC52YWxpZGF0ZUNhcmRDVkMoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBjYXJkSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFsaWRhdGVDYXJkSW5wdXQoY2FyZElucHV0LCBfcGF5Zm9ybTIuZGVmYXVsdC52YWxpZGF0ZUNhcmROdW1iZXIoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpO1xuICAgIH0pO1xuXG4gICAgY2FyZENvZGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkQ29kZUlucHV0LCBfcGF5Zm9ybTIuZGVmYXVsdC52YWxpZGF0ZUNhcmRDVkMoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpO1xuICAgIH0pO1xuXG4gICAgaWYgKGNhcmRFeHBpcmF0aW9uKSB7XG4gICAgICAgIGNhcmRFeHBpcmF0aW9uSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChjYXJkQ29kZS5jbGFzc0xpc3QuY29udGFpbnMoJ2Vycm9yJykpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkQ29kZUlucHV0LCBfcGF5Zm9ybTIuZGVmYXVsdC52YWxpZGF0ZUNhcmRDVkMoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjYXJkRXhwaXJhdGlvbklucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkSW5wdXQsIF9wYXlmb3JtMi5kZWZhdWx0LnZhbGlkYXRlQ2FyZE51bWJlcihldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjYXJkTW9udGgpIHtcbiAgICAgICAgY2FyZE1vbnRoU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZERhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGNhcmRZZWFyKSB7XG4gICAgICAgIGNhcmRZZWFyU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZERhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gW10uZm9yRWFjaC5jYWxsKCBjYXJkRGF0ZSwgZnVuY3Rpb24oIGl0ZW0gKSB7XG4gICAgLy8gICAgIGxldCBzZWxlY3QgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuICAgIC8vXG4gICAgLy8gICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgLy8gICAgICAgICB2YWxpZGF0ZUNhcmREYXRlKClcbiAgICAvLyAgICAgfSk7XG4gICAgLy8gfSk7XG5cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZUNhcmRJbnB1dChlbGVtZW50LCB2YWxpZCwgZXZlbnQpIHtcblxuICAgICAgICBpZiAodmFsaWQgPT09IGZhbHNlICYmICFldmVudC50YXJnZXQudmFsdWUgPT0gJycpIHtcbiAgICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBjYXJkRmllbGQucXVlcnlTZWxlY3RvcignLm9tZy1lcnJvcicpO1xuICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgICAgICAgICBlcnJvck1lc3NhZ2UuaW5uZXJIVE1MID0gJ1RoaXMgY2FyZCBudW1iZXIgaXMgbm90IHZhbGlkJztcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQudmFsdWUgPT0gJycgfHwgdmFsaWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVDYXJkRGF0ZSgpIHtcbiAgICAgICAgdmFyIG1vbnRoID0gY2FyZE1vbnRoU2VsZWN0LnZhbHVlO1xuICAgICAgICB2YXIgeWVhciA9IGNhcmRZZWFyU2VsZWN0LnZhbHVlO1xuICAgICAgICB2YXIgdmFsaWRDYXJkRGF0ZSA9IF9wYXlmb3JtMi5kZWZhdWx0LnZhbGlkYXRlQ2FyZEV4cGlyeShtb250aCwgeWVhcik7XG5cbiAgICAgICAgaWYgKHZhbGlkQ2FyZERhdGUgPT09IGZhbHNlICYmICFtb250aCA9PSAnJyAmJiAheWVhciA9PSAnJykge1xuICAgICAgICAgICAgY2FyZE1vbnRoLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgICAgICAgICBjYXJkWWVhci5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbGlkQ2FyZERhdGUgPT09IHRydWUgfHwgbW9udGggPT0gJycgJiYgeWVhciA9PSAnJykge1xuICAgICAgICAgICAgY2FyZE1vbnRoLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XG4gICAgICAgICAgICBjYXJkWWVhci5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIF9wYXlmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblxudmFyIF9wYXlmb3JtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BheWZvcm0pO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKG1vZHVsZSkge1xuLypcbiAgUGF5Zm9ybSBKYXZhc2NyaXB0IExpYnJhcnlcblxuICBVUkw6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb25kYXZpZGpvaG4vcGF5Zm9ybVxuICBBdXRob3I6IEpvbmF0aGFuIEQuIEpvaG5zb24gPG1lQGpvbmRhdmlkam9obi5jb20+XG4gIExpY2Vuc2U6IE1JVFxuICBWZXJzaW9uOiAxLjIuMVxuICovXG5cbihmdW5jdGlvbigpIHtcbiAgdmFyIGluZGV4T2YgPSBbXS5pbmRleE9mIHx8IGZ1bmN0aW9uKGl0ZW0pIHsgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgeyBpZiAoaSBpbiB0aGlzICYmIHRoaXNbaV0gPT09IGl0ZW0pIHJldHVybiBpOyB9IHJldHVybiAtMTsgfTtcblxuICAoZnVuY3Rpb24obmFtZSwgZGVmaW5pdGlvbikge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiICYmIG1vZHVsZSAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIG1vZHVsZS5leHBvcnRzID0gZGVmaW5pdGlvbigpO1xuICAgIH0gZWxzZSBpZiAodHJ1ZSkge1xuICAgICAgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oNCkobmFtZSwgZGVmaW5pdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzW25hbWVdID0gZGVmaW5pdGlvbigpO1xuICAgIH1cbiAgfSkoJ3BheWZvcm0nLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgX2V2ZW50Tm9ybWFsaXplLCBfZ2V0Q2FyZXRQb3MsIF9vbiwgY2FyZEZyb21OdW1iZXIsIGNhcmRGcm9tVHlwZSwgZGVmYXVsdEZvcm1hdCwgZm9ybWF0QmFja0NhcmROdW1iZXIsIGZvcm1hdEJhY2tFeHBpcnksIGZvcm1hdENhcmRFeHBpcnksIGZvcm1hdENhcmROdW1iZXIsIGZvcm1hdEZvcndhcmRFeHBpcnksIGZvcm1hdEZvcndhcmRTbGFzaEFuZFNwYWNlLCBoYXNUZXh0U2VsZWN0ZWQsIGx1aG5DaGVjaywgcGF5Zm9ybSwgcmVGb3JtYXRDVkMsIHJlRm9ybWF0Q2FyZE51bWJlciwgcmVGb3JtYXRFeHBpcnksIHJlcGxhY2VGdWxsV2lkdGhDaGFycywgcmVzdHJpY3RDVkMsIHJlc3RyaWN0Q2FyZE51bWJlciwgcmVzdHJpY3RFeHBpcnksIHJlc3RyaWN0TnVtZXJpYztcbiAgICBfZ2V0Q2FyZXRQb3MgPSBmdW5jdGlvbihlbGUpIHtcbiAgICAgIHZhciByLCByYywgcmU7XG4gICAgICBpZiAoZWxlLnNlbGVjdGlvblN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGVsZS5zZWxlY3Rpb25TdGFydDtcbiAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgZWxlLmZvY3VzKCk7XG4gICAgICAgIHIgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgcmUgPSBlbGUuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICAgIHJjID0gcmUuZHVwbGljYXRlKCk7XG4gICAgICAgIHJlLm1vdmVUb0Jvb2ttYXJrKHIuZ2V0Qm9va21hcmsoKSk7XG4gICAgICAgIHJjLnNldEVuZFBvaW50KCdFbmRUb1N0YXJ0JywgcmUpO1xuICAgICAgICByZXR1cm4gcmMudGV4dC5sZW5ndGg7XG4gICAgICB9XG4gICAgfTtcbiAgICBfZXZlbnROb3JtYWxpemUgPSBmdW5jdGlvbihsaXN0ZW5lcikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGUgPT0gbnVsbCkge1xuICAgICAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgZS50YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG4gICAgICAgIGUud2hpY2ggPSBlLndoaWNoIHx8IGUua2V5Q29kZTtcbiAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQgPT0gbnVsbCkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJldHVyblZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdGVuZXIoZSk7XG4gICAgICB9O1xuICAgIH07XG4gICAgX29uID0gZnVuY3Rpb24oZWxlLCBldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgIGxpc3RlbmVyID0gX2V2ZW50Tm9ybWFsaXplKGxpc3RlbmVyKTtcbiAgICAgIGlmIChlbGUuYWRkRXZlbnRMaXN0ZW5lciAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBlbGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIsIGZhbHNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBlbGUuYXR0YWNoRXZlbnQoXCJvblwiICsgZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHBheWZvcm0gPSB7fTtcbiAgICBkZWZhdWx0Rm9ybWF0ID0gLyhcXGR7MSw0fSkvZztcbiAgICBwYXlmb3JtLmNhcmRzID0gW1xuICAgICAge1xuICAgICAgICB0eXBlOiAndmlzYWVsZWN0cm9uJyxcbiAgICAgICAgcGF0dGVybjogL140KDAyNnwxNzUwMHw0MDV8NTA4fDg0NHw5MVszN10pLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdtYWVzdHJvJyxcbiAgICAgICAgcGF0dGVybjogL14oNSgwMTh8MFsyM118WzY4XSl8NigzOXw3KSkvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOV0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdmb3JicnVnc2ZvcmVuaW5nZW4nLFxuICAgICAgICBwYXR0ZXJuOiAvXjYwMC8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnZGFua29ydCcsXG4gICAgICAgIHBhdHRlcm46IC9eNTAxOS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAndmlzYScsXG4gICAgICAgIHBhdHRlcm46IC9eNC8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTMsIDE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ21hc3RlcmNhcmQnLFxuICAgICAgICBwYXR0ZXJuOiAvXig1WzEtNV18MlsyLTddKS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnYW1leCcsXG4gICAgICAgIHBhdHRlcm46IC9eM1s0N10vLFxuICAgICAgICBmb3JtYXQ6IC8oXFxkezEsNH0pKFxcZHsxLDZ9KT8oXFxkezEsNX0pPy8sXG4gICAgICAgIGxlbmd0aDogWzE1XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbMywgNF0sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2RpbmVyc2NsdWInLFxuICAgICAgICBwYXR0ZXJuOiAvXjNbMDY4OV0vLFxuICAgICAgICBmb3JtYXQ6IC8oXFxkezEsNH0pKFxcZHsxLDR9KT8oXFxkezEsNH0pPyhcXGR7MSwyfSk/LyxcbiAgICAgICAgbGVuZ3RoOiBbMTRdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnZGlzY292ZXInLFxuICAgICAgICBwYXR0ZXJuOiAvXjYoWzA0NV18MjIpLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICd1bmlvbnBheScsXG4gICAgICAgIHBhdHRlcm46IC9eKDYyfDg4KS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTYsIDE3LCAxOCwgMTldLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogZmFsc2VcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2pjYicsXG4gICAgICAgIHBhdHRlcm46IC9eMzUvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH1cbiAgICBdO1xuICAgIGNhcmRGcm9tTnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICB2YXIgY2FyZCwgaSwgbGVuLCByZWY7XG4gICAgICBudW0gPSAobnVtICsgJycpLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gICAgICByZWYgPSBwYXlmb3JtLmNhcmRzO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNhcmQgPSByZWZbaV07XG4gICAgICAgIGlmIChjYXJkLnBhdHRlcm4udGVzdChudW0pKSB7XG4gICAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIGNhcmRGcm9tVHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgIHZhciBjYXJkLCBpLCBsZW4sIHJlZjtcbiAgICAgIHJlZiA9IHBheWZvcm0uY2FyZHM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2FyZCA9IHJlZltpXTtcbiAgICAgICAgaWYgKGNhcmQudHlwZSA9PT0gdHlwZSkge1xuICAgICAgICAgIHJldHVybiBjYXJkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBsdWhuQ2hlY2sgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciBkaWdpdCwgZGlnaXRzLCBpLCBsZW4sIG9kZCwgc3VtO1xuICAgICAgb2RkID0gdHJ1ZTtcbiAgICAgIHN1bSA9IDA7XG4gICAgICBkaWdpdHMgPSAobnVtICsgJycpLnNwbGl0KCcnKS5yZXZlcnNlKCk7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBkaWdpdHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZGlnaXQgPSBkaWdpdHNbaV07XG4gICAgICAgIGRpZ2l0ID0gcGFyc2VJbnQoZGlnaXQsIDEwKTtcbiAgICAgICAgaWYgKChvZGQgPSAhb2RkKSkge1xuICAgICAgICAgIGRpZ2l0ICo9IDI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRpZ2l0ID4gOSkge1xuICAgICAgICAgIGRpZ2l0IC09IDk7XG4gICAgICAgIH1cbiAgICAgICAgc3VtICs9IGRpZ2l0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN1bSAlIDEwID09PSAwO1xuICAgIH07XG4gICAgaGFzVGV4dFNlbGVjdGVkID0gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgICB2YXIgcmVmO1xuICAgICAgaWYgKCh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgZG9jdW1lbnQgIT09IG51bGwgPyAocmVmID0gZG9jdW1lbnQuc2VsZWN0aW9uKSAhPSBudWxsID8gcmVmLmNyZWF0ZVJhbmdlIDogdm9pZCAwIDogdm9pZCAwKSAhPSBudWxsKSB7XG4gICAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS50ZXh0KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiAodGFyZ2V0LnNlbGVjdGlvblN0YXJ0ICE9IG51bGwpICYmIHRhcmdldC5zZWxlY3Rpb25TdGFydCAhPT0gdGFyZ2V0LnNlbGVjdGlvbkVuZDtcbiAgICB9O1xuICAgIHJlcGxhY2VGdWxsV2lkdGhDaGFycyA9IGZ1bmN0aW9uKHN0cikge1xuICAgICAgdmFyIGNoYXIsIGNoYXJzLCBmdWxsV2lkdGgsIGhhbGZXaWR0aCwgaSwgaWR4LCBsZW4sIHZhbHVlO1xuICAgICAgaWYgKHN0ciA9PSBudWxsKSB7XG4gICAgICAgIHN0ciA9ICcnO1xuICAgICAgfVxuICAgICAgZnVsbFdpZHRoID0gJ1xcdWZmMTBcXHVmZjExXFx1ZmYxMlxcdWZmMTNcXHVmZjE0XFx1ZmYxNVxcdWZmMTZcXHVmZjE3XFx1ZmYxOFxcdWZmMTknO1xuICAgICAgaGFsZldpZHRoID0gJzAxMjM0NTY3ODknO1xuICAgICAgdmFsdWUgPSAnJztcbiAgICAgIGNoYXJzID0gc3RyLnNwbGl0KCcnKTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGNoYXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNoYXIgPSBjaGFyc1tpXTtcbiAgICAgICAgaWR4ID0gZnVsbFdpZHRoLmluZGV4T2YoY2hhcik7XG4gICAgICAgIGlmIChpZHggPiAtMSkge1xuICAgICAgICAgIGNoYXIgPSBoYWxmV2lkdGhbaWR4XTtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZSArPSBjaGFyO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gICAgcmVGb3JtYXRDYXJkTnVtYmVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvcjtcbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBlLnRhcmdldC52YWx1ZSA9IHBheWZvcm0uZm9ybWF0Q2FyZE51bWJlcihlLnRhcmdldC52YWx1ZSk7XG4gICAgICBpZiAoKGN1cnNvciAhPSBudWxsKSAmJiBlLnR5cGUgIT09ICdjaGFuZ2UnKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3IsIGN1cnNvcik7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRDYXJkTnVtYmVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGNhcmQsIGN1cnNvciwgZGlnaXQsIGxlbmd0aCwgcmUsIHVwcGVyTGVuZ3RoLCB2YWx1ZTtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcih2YWx1ZSArIGRpZ2l0KTtcbiAgICAgIGxlbmd0aCA9ICh2YWx1ZS5yZXBsYWNlKC9cXEQvZywgJycpICsgZGlnaXQpLmxlbmd0aDtcbiAgICAgIHVwcGVyTGVuZ3RoID0gMTY7XG4gICAgICBpZiAoY2FyZCkge1xuICAgICAgICB1cHBlckxlbmd0aCA9IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdO1xuICAgICAgfVxuICAgICAgaWYgKGxlbmd0aCA+PSB1cHBlckxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgaWYgKGN1cnNvciAmJiBjdXJzb3IgIT09IHZhbHVlLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoY2FyZCAmJiBjYXJkLnR5cGUgPT09ICdhbWV4Jykge1xuICAgICAgICByZSA9IC9eKFxcZHs0fXxcXGR7NH1cXHNcXGR7Nn0pJC87XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZSA9IC8oPzpefFxccykoXFxkezR9KSQvO1xuICAgICAgfVxuICAgICAgaWYgKHJlLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsdWUgKyBcIiBcIiArIGRpZ2l0O1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAocmUudGVzdCh2YWx1ZSArIGRpZ2l0KSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9ICh2YWx1ZSArIGRpZ2l0KSArIFwiIFwiO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdEJhY2tDYXJkTnVtYmVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvciwgdmFsdWU7XG4gICAgICB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKGUud2hpY2ggIT09IDgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGlmIChjdXJzb3IgJiYgY3Vyc29yICE9PSB2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKC9cXGRcXHMkLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xcZFxccyQvLCAnJyk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICgvXFxzXFxkPyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxkJC8sICcnKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZUZvcm1hdEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjdXJzb3I7XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgZS50YXJnZXQudmFsdWUgPSBwYXlmb3JtLmZvcm1hdENhcmRFeHBpcnkoZS50YXJnZXQudmFsdWUpO1xuICAgICAgaWYgKChjdXJzb3IgIT0gbnVsbCkgJiYgZS50eXBlICE9PSAnY2hhbmdlJykge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yLCBjdXJzb3IpO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0Q2FyZEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBkaWdpdCwgdmFsO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWwgPSBlLnRhcmdldC52YWx1ZSArIGRpZ2l0O1xuICAgICAgaWYgKC9eXFxkJC8udGVzdCh2YWwpICYmICh2YWwgIT09ICcwJyAmJiB2YWwgIT09ICcxJykpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSBcIjBcIiArIHZhbCArIFwiIC8gXCI7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICgvXlxcZFxcZCQvLnRlc3QodmFsKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbCArIFwiIC8gXCI7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0Rm9yd2FyZEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBkaWdpdCwgdmFsO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWwgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgIGlmICgvXlxcZFxcZCQvLnRlc3QodmFsKSkge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWwgKyBcIiAvIFwiO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0Rm9yd2FyZFNsYXNoQW5kU3BhY2UgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgdmFsLCB3aGljaDtcbiAgICAgIHdoaWNoID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghKHdoaWNoID09PSAnLycgfHwgd2hpY2ggPT09ICcgJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsID0gZS50YXJnZXQudmFsdWU7XG4gICAgICBpZiAoL15cXGQkLy50ZXN0KHZhbCkgJiYgdmFsICE9PSAnMCcpIHtcbiAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gXCIwXCIgKyB2YWwgKyBcIiAvIFwiO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0QmFja0V4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjdXJzb3IsIHZhbHVlO1xuICAgICAgdmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgIGlmIChlLndoaWNoICE9PSA4KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBpZiAoY3Vyc29yICYmIGN1cnNvciAhPT0gdmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICgvXFxkXFxzXFwvXFxzJC8udGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXGRcXHNcXC9cXHMkLywgJycpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlRm9ybWF0Q1ZDID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvcjtcbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBlLnRhcmdldC52YWx1ZSA9IHJlcGxhY2VGdWxsV2lkdGhDaGFycyhlLnRhcmdldC52YWx1ZSkucmVwbGFjZSgvXFxEL2csICcnKS5zbGljZSgwLCA0KTtcbiAgICAgIGlmICgoY3Vyc29yICE9IG51bGwpICYmIGUudHlwZSAhPT0gJ2NoYW5nZScpIHtcbiAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGN1cnNvciwgY3Vyc29yKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlc3RyaWN0TnVtZXJpYyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBpbnB1dDtcbiAgICAgIGlmIChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChlLndoaWNoID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChlLndoaWNoIDwgMzMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaW5wdXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGlucHV0KSkge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVzdHJpY3RDYXJkTnVtYmVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGNhcmQsIGRpZ2l0LCB2YWx1ZTtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGhhc1RleHRTZWxlY3RlZChlLnRhcmdldCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSAoZS50YXJnZXQudmFsdWUgKyBkaWdpdCkucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcih2YWx1ZSk7XG4gICAgICBpZiAoY2FyZCAmJiB2YWx1ZS5sZW5ndGggPiBjYXJkLmxlbmd0aFtjYXJkLmxlbmd0aC5sZW5ndGggLSAxXSkge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSBlbHNlIGlmICh2YWx1ZS5sZW5ndGggPiAxNikge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVzdHJpY3RFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgZGlnaXQsIHZhbHVlO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlICsgZGlnaXQ7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gICAgICBpZiAodmFsdWUubGVuZ3RoID4gNikge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVzdHJpY3RDVkMgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgZGlnaXQsIHZhbDtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGhhc1RleHRTZWxlY3RlZChlLnRhcmdldCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsID0gZS50YXJnZXQudmFsdWUgKyBkaWdpdDtcbiAgICAgIGlmICh2YWwubGVuZ3RoID4gNCkge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgcGF5Zm9ybS5jdmNJbnB1dCA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0Q1ZDKTtcbiAgICAgIF9vbihpbnB1dCwgJ3Bhc3RlJywgcmVGb3JtYXRDVkMpO1xuICAgICAgX29uKGlucHV0LCAnY2hhbmdlJywgcmVGb3JtYXRDVkMpO1xuICAgICAgcmV0dXJuIF9vbihpbnB1dCwgJ2lucHV0JywgcmVGb3JtYXRDVkMpO1xuICAgIH07XG4gICAgcGF5Zm9ybS5leHBpcnlJbnB1dCA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0RXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgZm9ybWF0Q2FyZEV4cGlyeSk7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIGZvcm1hdEZvcndhcmRTbGFzaEFuZFNwYWNlKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgZm9ybWF0Rm9yd2FyZEV4cGlyeSk7XG4gICAgICBfb24oaW5wdXQsICdrZXlkb3duJywgZm9ybWF0QmFja0V4cGlyeSk7XG4gICAgICBfb24oaW5wdXQsICdjaGFuZ2UnLCByZUZvcm1hdEV4cGlyeSk7XG4gICAgICByZXR1cm4gX29uKGlucHV0LCAnaW5wdXQnLCByZUZvcm1hdEV4cGlyeSk7XG4gICAgfTtcbiAgICBwYXlmb3JtLmNhcmROdW1iZXJJbnB1dCA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0Q2FyZE51bWJlcik7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIGZvcm1hdENhcmROdW1iZXIpO1xuICAgICAgX29uKGlucHV0LCAna2V5ZG93bicsIGZvcm1hdEJhY2tDYXJkTnVtYmVyKTtcbiAgICAgIF9vbihpbnB1dCwgJ3Bhc3RlJywgcmVGb3JtYXRDYXJkTnVtYmVyKTtcbiAgICAgIF9vbihpbnB1dCwgJ2NoYW5nZScsIHJlRm9ybWF0Q2FyZE51bWJlcik7XG4gICAgICByZXR1cm4gX29uKGlucHV0LCAnaW5wdXQnLCByZUZvcm1hdENhcmROdW1iZXIpO1xuICAgIH07XG4gICAgcGF5Zm9ybS5udW1lcmljSW5wdXQgPSBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgX29uKGlucHV0LCAncGFzdGUnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgX29uKGlucHV0LCAnY2hhbmdlJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIHJldHVybiBfb24oaW5wdXQsICdpbnB1dCcsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgfTtcbiAgICBwYXlmb3JtLnBhcnNlQ2FyZEV4cGlyeSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbW9udGgsIHByZWZpeCwgcmVmLCB5ZWFyO1xuICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXHMvZywgJycpO1xuICAgICAgcmVmID0gdmFsdWUuc3BsaXQoJy8nLCAyKSwgbW9udGggPSByZWZbMF0sIHllYXIgPSByZWZbMV07XG4gICAgICBpZiAoKHllYXIgIT0gbnVsbCA/IHllYXIubGVuZ3RoIDogdm9pZCAwKSA9PT0gMiAmJiAvXlxcZCskLy50ZXN0KHllYXIpKSB7XG4gICAgICAgIHByZWZpeCA9IChuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgcHJlZml4ID0gcHJlZml4LnRvU3RyaW5nKCkuc2xpY2UoMCwgMik7XG4gICAgICAgIHllYXIgPSBwcmVmaXggKyB5ZWFyO1xuICAgICAgfVxuICAgICAgbW9udGggPSBwYXJzZUludChtb250aCwgMTApO1xuICAgICAgeWVhciA9IHBhcnNlSW50KHllYXIsIDEwKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1vbnRoOiBtb250aCxcbiAgICAgICAgeWVhcjogeWVhclxuICAgICAgfTtcbiAgICB9O1xuICAgIHBheWZvcm0udmFsaWRhdGVDYXJkTnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICB2YXIgY2FyZCwgcmVmO1xuICAgICAgbnVtID0gKG51bSArICcnKS5yZXBsYWNlKC9cXHMrfC0vZywgJycpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KG51bSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKG51bSk7XG4gICAgICBpZiAoIWNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIChyZWYgPSBudW0ubGVuZ3RoLCBpbmRleE9mLmNhbGwoY2FyZC5sZW5ndGgsIHJlZikgPj0gMCkgJiYgKGNhcmQubHVobiA9PT0gZmFsc2UgfHwgbHVobkNoZWNrKG51bSkpO1xuICAgIH07XG4gICAgcGF5Zm9ybS52YWxpZGF0ZUNhcmRFeHBpcnkgPSBmdW5jdGlvbihtb250aCwgeWVhcikge1xuICAgICAgdmFyIGN1cnJlbnRUaW1lLCBleHBpcnksIHJlZjtcbiAgICAgIGlmICh0eXBlb2YgbW9udGggPT09ICdvYmplY3QnICYmICdtb250aCcgaW4gbW9udGgpIHtcbiAgICAgICAgcmVmID0gbW9udGgsIG1vbnRoID0gcmVmLm1vbnRoLCB5ZWFyID0gcmVmLnllYXI7XG4gICAgICB9XG4gICAgICBpZiAoIShtb250aCAmJiB5ZWFyKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBtb250aCA9IFN0cmluZyhtb250aCkudHJpbSgpO1xuICAgICAgeWVhciA9IFN0cmluZyh5ZWFyKS50cmltKCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QobW9udGgpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghL15cXGQrJC8udGVzdCh5ZWFyKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoISgoMSA8PSBtb250aCAmJiBtb250aCA8PSAxMikpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICh5ZWFyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBpZiAoeWVhciA8IDcwKSB7XG4gICAgICAgICAgeWVhciA9IFwiMjBcIiArIHllYXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgeWVhciA9IFwiMTlcIiArIHllYXI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh5ZWFyLmxlbmd0aCAhPT0gNCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBleHBpcnkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCk7XG4gICAgICBjdXJyZW50VGltZSA9IG5ldyBEYXRlO1xuICAgICAgZXhwaXJ5LnNldE1vbnRoKGV4cGlyeS5nZXRNb250aCgpIC0gMSk7XG4gICAgICBleHBpcnkuc2V0TW9udGgoZXhwaXJ5LmdldE1vbnRoKCkgKyAxLCAxKTtcbiAgICAgIHJldHVybiBleHBpcnkgPiBjdXJyZW50VGltZTtcbiAgICB9O1xuICAgIHBheWZvcm0udmFsaWRhdGVDYXJkQ1ZDID0gZnVuY3Rpb24oY3ZjLCB0eXBlKSB7XG4gICAgICB2YXIgY2FyZCwgcmVmO1xuICAgICAgY3ZjID0gU3RyaW5nKGN2YykudHJpbSgpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGN2YykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY2FyZCA9IGNhcmRGcm9tVHlwZSh0eXBlKTtcbiAgICAgIGlmIChjYXJkICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJlZiA9IGN2Yy5sZW5ndGgsIGluZGV4T2YuY2FsbChjYXJkLmN2Y0xlbmd0aCwgcmVmKSA+PSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGN2Yy5sZW5ndGggPj0gMyAmJiBjdmMubGVuZ3RoIDw9IDQ7XG4gICAgICB9XG4gICAgfTtcbiAgICBwYXlmb3JtLnBhcnNlQ2FyZFR5cGUgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciByZWY7XG4gICAgICBpZiAoIW51bSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoKHJlZiA9IGNhcmRGcm9tTnVtYmVyKG51bSkpICE9IG51bGwgPyByZWYudHlwZSA6IHZvaWQgMCkgfHwgbnVsbDtcbiAgICB9O1xuICAgIHBheWZvcm0uZm9ybWF0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIGNhcmQsIGdyb3VwcywgcmVmLCB1cHBlckxlbmd0aDtcbiAgICAgIG51bSA9IHJlcGxhY2VGdWxsV2lkdGhDaGFycyhudW0pO1xuICAgICAgbnVtID0gbnVtLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gICAgICBjYXJkID0gY2FyZEZyb21OdW1iZXIobnVtKTtcbiAgICAgIGlmICghY2FyZCkge1xuICAgICAgICByZXR1cm4gbnVtO1xuICAgICAgfVxuICAgICAgdXBwZXJMZW5ndGggPSBjYXJkLmxlbmd0aFtjYXJkLmxlbmd0aC5sZW5ndGggLSAxXTtcbiAgICAgIG51bSA9IG51bS5zbGljZSgwLCB1cHBlckxlbmd0aCk7XG4gICAgICBpZiAoY2FyZC5mb3JtYXQuZ2xvYmFsKSB7XG4gICAgICAgIHJldHVybiAocmVmID0gbnVtLm1hdGNoKGNhcmQuZm9ybWF0KSkgIT0gbnVsbCA/IHJlZi5qb2luKCcgJykgOiB2b2lkIDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBncm91cHMgPSBjYXJkLmZvcm1hdC5leGVjKG51bSk7XG4gICAgICAgIGlmIChncm91cHMgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBncm91cHMuc2hpZnQoKTtcbiAgICAgICAgZ3JvdXBzID0gZ3JvdXBzLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgcmV0dXJuIGdyb3Vwcy5qb2luKCcgJyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBwYXlmb3JtLmZvcm1hdENhcmRFeHBpcnkgPSBmdW5jdGlvbihleHBpcnkpIHtcbiAgICAgIHZhciBtb24sIHBhcnRzLCBzZXAsIHllYXI7XG4gICAgICBleHBpcnkgPSByZXBsYWNlRnVsbFdpZHRoQ2hhcnMoZXhwaXJ5KTtcbiAgICAgIHBhcnRzID0gZXhwaXJ5Lm1hdGNoKC9eXFxEKihcXGR7MSwyfSkoXFxEKyk/KFxcZHsxLDR9KT8vKTtcbiAgICAgIGlmICghcGFydHMpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgICAgbW9uID0gcGFydHNbMV0gfHwgJyc7XG4gICAgICBzZXAgPSBwYXJ0c1syXSB8fCAnJztcbiAgICAgIHllYXIgPSBwYXJ0c1szXSB8fCAnJztcbiAgICAgIGlmICh5ZWFyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2VwID0gJyAvICc7XG4gICAgICB9IGVsc2UgaWYgKHNlcCA9PT0gJyAvJykge1xuICAgICAgICBtb24gPSBtb24uc3Vic3RyaW5nKDAsIDEpO1xuICAgICAgICBzZXAgPSAnJztcbiAgICAgIH0gZWxzZSBpZiAobW9uLmxlbmd0aCA9PT0gMiB8fCBzZXAubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXAgPSAnIC8gJztcbiAgICAgIH0gZWxzZSBpZiAobW9uLmxlbmd0aCA9PT0gMSAmJiAobW9uICE9PSAnMCcgJiYgbW9uICE9PSAnMScpKSB7XG4gICAgICAgIG1vbiA9IFwiMFwiICsgbW9uO1xuICAgICAgICBzZXAgPSAnIC8gJztcbiAgICAgIH1cbiAgICAgIHJldHVybiBtb24gKyBzZXAgKyB5ZWFyO1xuICAgIH07XG4gICAgcmV0dXJuIHBheWZvcm07XG4gIH0pO1xuXG59KS5jYWxsKHRoaXMpO1xuXG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygzKShtb2R1bGUpKSlcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdGlmKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn07XHJcblxuXG4vKioqLyB9KSxcbi8qIDQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcclxuXHR0aHJvdyBuZXcgRXJyb3IoXCJkZWZpbmUgY2Fubm90IGJlIHVzZWQgaW5kaXJlY3RcIik7XHJcbn07XHJcblxuXG4vKioqLyB9KVxuLyoqKioqKi8gXSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGluZGV4LmJ1bmRsZS5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9kaXN0L1wiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDhlNzhkZWZhNDgxYjZjOGQ2N2E4IiwiaW1wb3J0IGNhcmRWYWxpZGF0aW9uIGZyb20gJy4vY2FyZC12YWxpZGF0aW9uJztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCAnLm9tZy1mb3JtLXdyYXBwZXInICk7XG5cbiAgICBpZiAoIGZvcm1zICkge1xuICAgICAgICBbXS5mb3JFYWNoLmNhbGwoIGZvcm1zLCBmdW5jdGlvbiggZm9ybVdyYXBwZXIgKSB7XG4gICAgICAgICAgICBjb25zdCBmb3JtVHlwZXMgPSBKU09OLnBhcnNlKCBmb3JtV3JhcHBlci5kYXRhc2V0LmZvcm10eXBlICk7XG5cbiAgICAgICAgICAgIGlmICggLTEgIT09IGZvcm1UeXBlcy5pbmRleE9mKCdhdXRob3JpemVfbmV0JykgKSB7XG4gICAgICAgICAgICAgICAgY2FyZFZhbGlkYXRpb24oIGZvcm1XcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoICdmb3JtJyApICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gKTtcblxuICAgIH1cblxufSApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vaW5kZXguanMiLCJpbXBvcnQgcGF5Zm9ybSBmcm9tICdwYXlmb3JtJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oIGZvcm0gKSB7XG5cbiAgICBpZiAoICFmb3JtICkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgY2FyZEZpZWxkICA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb21nLWZvcm1zLWNhcmRfbnVtYmVyJyk7XG4gICAgY29uc3QgY2FyZElucHV0ICA9ICBjYXJkRmllbGQucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcblxuICAgIGNvbnN0IGNhcmRNb250aCAgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29tZy1mb3Jtcy1leHBpcmF0aW9uX21vbnRoJyk7XG4gICAgbGV0IGNhcmRNb250aFNlbGVjdDtcbiAgICBpZiAoIGNhcmRNb250aCApIHtcbiAgICAgICAgY2FyZE1vbnRoU2VsZWN0ID0gY2FyZE1vbnRoLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuICAgIH1cblxuICAgIGNvbnN0IGNhcmRZZWFyICAgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29tZy1mb3Jtcy1leHBpcmF0aW9uX3llYXInKTtcbiAgICBsZXQgY2FyZFllYXJTZWxlY3Q7XG4gICAgaWYgKCBjYXJkWWVhciApIHtcbiAgICAgICAgIGNhcmRZZWFyU2VsZWN0ID0gY2FyZFllYXIucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgY2FyZENvZGUgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtY2FyZF9jb2RlJyk7XG4gICAgY29uc3QgY2FyZENvZGVJbnB1dCA9IGNhcmRDb2RlLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG5cbiAgICBjb25zdCBjYXJkRXhwaXJhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtZXhwaXJhdGlvbl9kYXRlJyk7XG4gICAgbGV0IGNhcmRFeHBpcmF0aW9uSW5wdXQ7XG4gICAgaWYgKCBjYXJkRXhwaXJhdGlvbiApIHtcbiAgICAgICAgY2FyZEV4cGlyYXRpb25JbnB1dCA9IGNhcmRFeHBpcmF0aW9uLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgfVxuXG4gICAgcGF5Zm9ybS5jYXJkTnVtYmVySW5wdXQoY2FyZElucHV0KTtcbiAgICBwYXlmb3JtLmN2Y0lucHV0KGNhcmRDb2RlSW5wdXQpO1xuXG4gICAgY2FyZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICBpZiAoIGNhcmRGaWVsZC5jbGFzc0xpc3QuY29udGFpbnMoJ2Vycm9yJykgKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkSW5wdXQsIHBheWZvcm0udmFsaWRhdGVDYXJkTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSksIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgY2FyZENvZGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgaWYgKCBjYXJkQ29kZS5jbGFzc0xpc3QuY29udGFpbnMoJ2Vycm9yJykgKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkQ29kZUlucHV0LCBwYXlmb3JtLnZhbGlkYXRlQ2FyZENWQyhldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGNhcmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkSW5wdXQsIHBheWZvcm0udmFsaWRhdGVDYXJkTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSksIGV2ZW50KVxuICAgIH0pO1xuXG4gICAgY2FyZENvZGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkQ29kZUlucHV0LCBwYXlmb3JtLnZhbGlkYXRlQ2FyZENWQyhldmVudC50YXJnZXQudmFsdWUpLCBldmVudClcbiAgICB9KTtcblxuICAgIGlmICggY2FyZEV4cGlyYXRpb24gKSB7XG4gICAgICAgIGNhcmRFeHBpcmF0aW9uSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCl7XG4gICAgICAgICAgICBpZiAoIGNhcmRDb2RlLmNsYXNzTGlzdC5jb250YWlucygnZXJyb3InKSApIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkQ29kZUlucHV0LCBwYXlmb3JtLnZhbGlkYXRlQ2FyZENWQyhldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNhcmRFeHBpcmF0aW9uSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZElucHV0KGNhcmRJbnB1dCwgcGF5Zm9ybS52YWxpZGF0ZUNhcmROdW1iZXIoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICggY2FyZE1vbnRoICkge1xuICAgICAgICBjYXJkTW9udGhTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFsaWRhdGVDYXJkRGF0ZSgpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICggY2FyZFllYXIgKSB7XG4gICAgICAgIGNhcmRZZWFyU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZERhdGUoKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBbXS5mb3JFYWNoLmNhbGwoIGNhcmREYXRlLCBmdW5jdGlvbiggaXRlbSApIHtcbiAgICAvLyAgICAgbGV0IHNlbGVjdCA9IGl0ZW0ucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG4gICAgLy9cbiAgICAvLyAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAvLyAgICAgICAgIHZhbGlkYXRlQ2FyZERhdGUoKVxuICAgIC8vICAgICB9KTtcbiAgICAvLyB9KTtcblxuICAgIGZ1bmN0aW9uIHZhbGlkYXRlQ2FyZElucHV0KGVsZW1lbnQsIHZhbGlkLCBldmVudCkge1xuXG4gICAgICAgIGlmICggdmFsaWQgPT09IGZhbHNlICYmICFldmVudC50YXJnZXQudmFsdWUgPT0gJycgKSB7XG4gICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gY2FyZEZpZWxkLnF1ZXJ5U2VsZWN0b3IoJy5vbWctZXJyb3InKTtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlLmlubmVySFRNTCA9ICdUaGlzIGNhcmQgbnVtYmVyIGlzIG5vdCB2YWxpZCc7XG5cbiAgICAgICAgfSBlbHNlIGlmICggZXZlbnQudGFyZ2V0LnZhbHVlID09ICcnIHx8IHZhbGlkID09PSB0cnVlICApIHtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVDYXJkRGF0ZSgpIHtcbiAgICAgICAgbGV0IG1vbnRoID0gY2FyZE1vbnRoU2VsZWN0LnZhbHVlO1xuICAgICAgICBsZXQgeWVhciAgPSBjYXJkWWVhclNlbGVjdC52YWx1ZTtcbiAgICAgICAgbGV0IHZhbGlkQ2FyZERhdGUgPSBwYXlmb3JtLnZhbGlkYXRlQ2FyZEV4cGlyeSggbW9udGgsIHllYXIpO1xuXG4gICAgICAgIGlmICggdmFsaWRDYXJkRGF0ZSA9PT0gZmFsc2UgJiYgIW1vbnRoID09ICcnICYmICF5ZWFyID09ICcnICkge1xuICAgICAgICAgICAgY2FyZE1vbnRoLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgICAgICAgICBjYXJkWWVhci5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoIHZhbGlkQ2FyZERhdGUgPT09IHRydWUgfHwgbW9udGggPT0gJycgJiYgeWVhciA9PSAnJyAgICkge1xuICAgICAgICAgICAgY2FyZE1vbnRoLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XG4gICAgICAgICAgICBjYXJkWWVhci5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vY2FyZC12YWxpZGF0aW9uLmpzIiwiXG4vKlxuICBQYXlmb3JtIEphdmFzY3JpcHQgTGlicmFyeVxuXG4gIFVSTDogaHR0cHM6Ly9naXRodWIuY29tL2pvbmRhdmlkam9obi9wYXlmb3JtXG4gIEF1dGhvcjogSm9uYXRoYW4gRC4gSm9obnNvbiA8bWVAam9uZGF2aWRqb2huLmNvbT5cbiAgTGljZW5zZTogTUlUXG4gIFZlcnNpb246IDEuMi4xXG4gKi9cblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgaW5kZXhPZiA9IFtdLmluZGV4T2YgfHwgZnVuY3Rpb24oaXRlbSkgeyBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7IGlmIChpIGluIHRoaXMgJiYgdGhpc1tpXSA9PT0gaXRlbSkgcmV0dXJuIGk7IH0gcmV0dXJuIC0xOyB9O1xuXG4gIChmdW5jdGlvbihuYW1lLCBkZWZpbml0aW9uKSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gbW9kdWxlLmV4cG9ydHMgPSBkZWZpbml0aW9uKCk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBkZWZpbmUuYW1kID09PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIGRlZmluZShuYW1lLCBkZWZpbml0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXNbbmFtZV0gPSBkZWZpbml0aW9uKCk7XG4gICAgfVxuICB9KSgncGF5Zm9ybScsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBfZXZlbnROb3JtYWxpemUsIF9nZXRDYXJldFBvcywgX29uLCBjYXJkRnJvbU51bWJlciwgY2FyZEZyb21UeXBlLCBkZWZhdWx0Rm9ybWF0LCBmb3JtYXRCYWNrQ2FyZE51bWJlciwgZm9ybWF0QmFja0V4cGlyeSwgZm9ybWF0Q2FyZEV4cGlyeSwgZm9ybWF0Q2FyZE51bWJlciwgZm9ybWF0Rm9yd2FyZEV4cGlyeSwgZm9ybWF0Rm9yd2FyZFNsYXNoQW5kU3BhY2UsIGhhc1RleHRTZWxlY3RlZCwgbHVobkNoZWNrLCBwYXlmb3JtLCByZUZvcm1hdENWQywgcmVGb3JtYXRDYXJkTnVtYmVyLCByZUZvcm1hdEV4cGlyeSwgcmVwbGFjZUZ1bGxXaWR0aENoYXJzLCByZXN0cmljdENWQywgcmVzdHJpY3RDYXJkTnVtYmVyLCByZXN0cmljdEV4cGlyeSwgcmVzdHJpY3ROdW1lcmljO1xuICAgIF9nZXRDYXJldFBvcyA9IGZ1bmN0aW9uKGVsZSkge1xuICAgICAgdmFyIHIsIHJjLCByZTtcbiAgICAgIGlmIChlbGUuc2VsZWN0aW9uU3RhcnQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZWxlLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICBlbGUuZm9jdXMoKTtcbiAgICAgICAgciA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICAgICAgICByZSA9IGVsZS5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICAgICAgcmMgPSByZS5kdXBsaWNhdGUoKTtcbiAgICAgICAgcmUubW92ZVRvQm9va21hcmsoci5nZXRCb29rbWFyaygpKTtcbiAgICAgICAgcmMuc2V0RW5kUG9pbnQoJ0VuZFRvU3RhcnQnLCByZSk7XG4gICAgICAgIHJldHVybiByYy50ZXh0Lmxlbmd0aDtcbiAgICAgIH1cbiAgICB9O1xuICAgIF9ldmVudE5vcm1hbGl6ZSA9IGZ1bmN0aW9uKGxpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoZSA9PSBudWxsKSB7XG4gICAgICAgICAgZSA9IHdpbmRvdy5ldmVudDtcbiAgICAgICAgfVxuICAgICAgICBlLnRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICAgICAgZS53aGljaCA9IGUud2hpY2ggfHwgZS5rZXlDb2RlO1xuICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0ZW5lcihlKTtcbiAgICAgIH07XG4gICAgfTtcbiAgICBfb24gPSBmdW5jdGlvbihlbGUsIGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgbGlzdGVuZXIgPSBfZXZlbnROb3JtYWxpemUobGlzdGVuZXIpO1xuICAgICAgaWYgKGVsZS5hZGRFdmVudExpc3RlbmVyICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGVsZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGVsZS5hdHRhY2hFdmVudChcIm9uXCIgKyBldmVudCwgbGlzdGVuZXIpO1xuICAgICAgfVxuICAgIH07XG4gICAgcGF5Zm9ybSA9IHt9O1xuICAgIGRlZmF1bHRGb3JtYXQgPSAvKFxcZHsxLDR9KS9nO1xuICAgIHBheWZvcm0uY2FyZHMgPSBbXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICd2aXNhZWxlY3Ryb24nLFxuICAgICAgICBwYXR0ZXJuOiAvXjQoMDI2fDE3NTAwfDQwNXw1MDh8ODQ0fDkxWzM3XSkvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ21hZXN0cm8nLFxuICAgICAgICBwYXR0ZXJuOiAvXig1KDAxOHwwWzIzXXxbNjhdKXw2KDM5fDcpKS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2ZvcmJydWdzZm9yZW5pbmdlbicsXG4gICAgICAgIHBhdHRlcm46IC9eNjAwLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdkYW5rb3J0JyxcbiAgICAgICAgcGF0dGVybjogL141MDE5LyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICd2aXNhJyxcbiAgICAgICAgcGF0dGVybjogL140LyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxMywgMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnbWFzdGVyY2FyZCcsXG4gICAgICAgIHBhdHRlcm46IC9eKDVbMS01XXwyWzItN10pLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdhbWV4JyxcbiAgICAgICAgcGF0dGVybjogL14zWzQ3XS8sXG4gICAgICAgIGZvcm1hdDogLyhcXGR7MSw0fSkoXFxkezEsNn0pPyhcXGR7MSw1fSk/LyxcbiAgICAgICAgbGVuZ3RoOiBbMTVdLFxuICAgICAgICBjdmNMZW5ndGg6IFszLCA0XSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnZGluZXJzY2x1YicsXG4gICAgICAgIHBhdHRlcm46IC9eM1swNjg5XS8sXG4gICAgICAgIGZvcm1hdDogLyhcXGR7MSw0fSkoXFxkezEsNH0pPyhcXGR7MSw0fSk/KFxcZHsxLDJ9KT8vLFxuICAgICAgICBsZW5ndGg6IFsxNF0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdkaXNjb3ZlcicsXG4gICAgICAgIHBhdHRlcm46IC9eNihbMDQ1XXwyMikvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ3VuaW9ucGF5JyxcbiAgICAgICAgcGF0dGVybjogL14oNjJ8ODgpLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNiwgMTcsIDE4LCAxOV0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiBmYWxzZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnamNiJyxcbiAgICAgICAgcGF0dGVybjogL14zNS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfVxuICAgIF07XG4gICAgY2FyZEZyb21OdW1iZXIgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciBjYXJkLCBpLCBsZW4sIHJlZjtcbiAgICAgIG51bSA9IChudW0gKyAnJykucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIHJlZiA9IHBheWZvcm0uY2FyZHM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2FyZCA9IHJlZltpXTtcbiAgICAgICAgaWYgKGNhcmQucGF0dGVybi50ZXN0KG51bSkpIHtcbiAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgY2FyZEZyb21UeXBlID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgdmFyIGNhcmQsIGksIGxlbiwgcmVmO1xuICAgICAgcmVmID0gcGF5Zm9ybS5jYXJkcztcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjYXJkID0gcmVmW2ldO1xuICAgICAgICBpZiAoY2FyZC50eXBlID09PSB0eXBlKSB7XG4gICAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIGx1aG5DaGVjayA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIGRpZ2l0LCBkaWdpdHMsIGksIGxlbiwgb2RkLCBzdW07XG4gICAgICBvZGQgPSB0cnVlO1xuICAgICAgc3VtID0gMDtcbiAgICAgIGRpZ2l0cyA9IChudW0gKyAnJykuc3BsaXQoJycpLnJldmVyc2UoKTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGRpZ2l0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBkaWdpdCA9IGRpZ2l0c1tpXTtcbiAgICAgICAgZGlnaXQgPSBwYXJzZUludChkaWdpdCwgMTApO1xuICAgICAgICBpZiAoKG9kZCA9ICFvZGQpKSB7XG4gICAgICAgICAgZGlnaXQgKj0gMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGlnaXQgPiA5KSB7XG4gICAgICAgICAgZGlnaXQgLT0gOTtcbiAgICAgICAgfVxuICAgICAgICBzdW0gKz0gZGlnaXQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3VtICUgMTAgPT09IDA7XG4gICAgfTtcbiAgICBoYXNUZXh0U2VsZWN0ZWQgPSBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgIHZhciByZWY7XG4gICAgICBpZiAoKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBkb2N1bWVudCAhPT0gbnVsbCA/IChyZWYgPSBkb2N1bWVudC5zZWxlY3Rpb24pICE9IG51bGwgPyByZWYuY3JlYXRlUmFuZ2UgOiB2b2lkIDAgOiB2b2lkIDApICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLnRleHQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuICh0YXJnZXQuc2VsZWN0aW9uU3RhcnQgIT0gbnVsbCkgJiYgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0ICE9PSB0YXJnZXQuc2VsZWN0aW9uRW5kO1xuICAgIH07XG4gICAgcmVwbGFjZUZ1bGxXaWR0aENoYXJzID0gZnVuY3Rpb24oc3RyKSB7XG4gICAgICB2YXIgY2hhciwgY2hhcnMsIGZ1bGxXaWR0aCwgaGFsZldpZHRoLCBpLCBpZHgsIGxlbiwgdmFsdWU7XG4gICAgICBpZiAoc3RyID09IG51bGwpIHtcbiAgICAgICAgc3RyID0gJyc7XG4gICAgICB9XG4gICAgICBmdWxsV2lkdGggPSAnXFx1ZmYxMFxcdWZmMTFcXHVmZjEyXFx1ZmYxM1xcdWZmMTRcXHVmZjE1XFx1ZmYxNlxcdWZmMTdcXHVmZjE4XFx1ZmYxOSc7XG4gICAgICBoYWxmV2lkdGggPSAnMDEyMzQ1Njc4OSc7XG4gICAgICB2YWx1ZSA9ICcnO1xuICAgICAgY2hhcnMgPSBzdHIuc3BsaXQoJycpO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gY2hhcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2hhciA9IGNoYXJzW2ldO1xuICAgICAgICBpZHggPSBmdWxsV2lkdGguaW5kZXhPZihjaGFyKTtcbiAgICAgICAgaWYgKGlkeCA+IC0xKSB7XG4gICAgICAgICAgY2hhciA9IGhhbGZXaWR0aFtpZHhdO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlICs9IGNoYXI7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICByZUZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yO1xuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGUudGFyZ2V0LnZhbHVlID0gcGF5Zm9ybS5mb3JtYXRDYXJkTnVtYmVyKGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgIGlmICgoY3Vyc29yICE9IG51bGwpICYmIGUudHlwZSAhPT0gJ2NoYW5nZScpIHtcbiAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGN1cnNvciwgY3Vyc29yKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY2FyZCwgY3Vyc29yLCBkaWdpdCwgbGVuZ3RoLCByZSwgdXBwZXJMZW5ndGgsIHZhbHVlO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKHZhbHVlICsgZGlnaXQpO1xuICAgICAgbGVuZ3RoID0gKHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJykgKyBkaWdpdCkubGVuZ3RoO1xuICAgICAgdXBwZXJMZW5ndGggPSAxNjtcbiAgICAgIGlmIChjYXJkKSB7XG4gICAgICAgIHVwcGVyTGVuZ3RoID0gY2FyZC5sZW5ndGhbY2FyZC5sZW5ndGgubGVuZ3RoIC0gMV07XG4gICAgICB9XG4gICAgICBpZiAobGVuZ3RoID49IHVwcGVyTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBpZiAoY3Vyc29yICYmIGN1cnNvciAhPT0gdmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJkICYmIGNhcmQudHlwZSA9PT0gJ2FtZXgnKSB7XG4gICAgICAgIHJlID0gL14oXFxkezR9fFxcZHs0fVxcc1xcZHs2fSkkLztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlID0gLyg/Ol58XFxzKShcXGR7NH0pJC87XG4gICAgICB9XG4gICAgICBpZiAocmUudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWx1ZSArIFwiIFwiICsgZGlnaXQ7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChyZS50ZXN0KHZhbHVlICsgZGlnaXQpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gKHZhbHVlICsgZGlnaXQpICsgXCIgXCI7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0QmFja0NhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yLCB2YWx1ZTtcbiAgICAgIHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICBpZiAoZS53aGljaCAhPT0gOCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgaWYgKGN1cnNvciAmJiBjdXJzb3IgIT09IHZhbHVlLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoL1xcZFxccyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxkXFxzJC8sICcnKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKC9cXHNcXGQ/JC8udGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXGQkLywgJycpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlRm9ybWF0RXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvcjtcbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBlLnRhcmdldC52YWx1ZSA9IHBheWZvcm0uZm9ybWF0Q2FyZEV4cGlyeShlLnRhcmdldC52YWx1ZSk7XG4gICAgICBpZiAoKGN1cnNvciAhPSBudWxsKSAmJiBlLnR5cGUgIT09ICdjaGFuZ2UnKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3IsIGN1cnNvcik7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRDYXJkRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGRpZ2l0LCB2YWw7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbCA9IGUudGFyZ2V0LnZhbHVlICsgZGlnaXQ7XG4gICAgICBpZiAoL15cXGQkLy50ZXN0KHZhbCkgJiYgKHZhbCAhPT0gJzAnICYmIHZhbCAhPT0gJzEnKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IFwiMFwiICsgdmFsICsgXCIgLyBcIjtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKC9eXFxkXFxkJC8udGVzdCh2YWwpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsICsgXCIgLyBcIjtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRGb3J3YXJkRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGRpZ2l0LCB2YWw7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKC9eXFxkXFxkJC8udGVzdCh2YWwpKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbCArIFwiIC8gXCI7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRGb3J3YXJkU2xhc2hBbmRTcGFjZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciB2YWwsIHdoaWNoO1xuICAgICAgd2hpY2ggPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEod2hpY2ggPT09ICcvJyB8fCB3aGljaCA9PT0gJyAnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWwgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgIGlmICgvXlxcZCQvLnRlc3QodmFsKSAmJiB2YWwgIT09ICcwJykge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSBcIjBcIiArIHZhbCArIFwiIC8gXCI7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRCYWNrRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvciwgdmFsdWU7XG4gICAgICB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKGUud2hpY2ggIT09IDgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGlmIChjdXJzb3IgJiYgY3Vyc29yICE9PSB2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKC9cXGRcXHNcXC9cXHMkLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xcZFxcc1xcL1xccyQvLCAnJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVGb3JtYXRDVkMgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yO1xuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGUudGFyZ2V0LnZhbHVlID0gcmVwbGFjZUZ1bGxXaWR0aENoYXJzKGUudGFyZ2V0LnZhbHVlKS5yZXBsYWNlKC9cXEQvZywgJycpLnNsaWNlKDAsIDQpO1xuICAgICAgaWYgKChjdXJzb3IgIT0gbnVsbCkgJiYgZS50eXBlICE9PSAnY2hhbmdlJykge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yLCBjdXJzb3IpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVzdHJpY3ROdW1lcmljID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGlucHV0O1xuICAgICAgaWYgKGUubWV0YUtleSB8fCBlLmN0cmxLZXkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGUud2hpY2ggPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGUud2hpY2ggPCAzMykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpbnB1dCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY2FyZCwgZGlnaXQsIHZhbHVlO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IChlLnRhcmdldC52YWx1ZSArIGRpZ2l0KS5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKHZhbHVlKTtcbiAgICAgIGlmIChjYXJkICYmIHZhbHVlLmxlbmd0aCA+IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdKSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9IGVsc2UgaWYgKHZhbHVlLmxlbmd0aCA+IDE2KSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBkaWdpdCwgdmFsdWU7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQoZS50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbHVlID0gZS50YXJnZXQudmFsdWUgKyBkaWdpdDtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiA2KSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdENWQyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBkaWdpdCwgdmFsO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWwgPSBlLnRhcmdldC52YWx1ZSArIGRpZ2l0O1xuICAgICAgaWYgKHZhbC5sZW5ndGggPiA0KSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBwYXlmb3JtLmN2Y0lucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3RDVkMpO1xuICAgICAgX29uKGlucHV0LCAncGFzdGUnLCByZUZvcm1hdENWQyk7XG4gICAgICBfb24oaW5wdXQsICdjaGFuZ2UnLCByZUZvcm1hdENWQyk7XG4gICAgICByZXR1cm4gX29uKGlucHV0LCAnaW5wdXQnLCByZUZvcm1hdENWQyk7XG4gICAgfTtcbiAgICBwYXlmb3JtLmV4cGlyeUlucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3RFeHBpcnkpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCBmb3JtYXRDYXJkRXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgZm9ybWF0Rm9yd2FyZFNsYXNoQW5kU3BhY2UpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCBmb3JtYXRGb3J3YXJkRXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleWRvd24nLCBmb3JtYXRCYWNrRXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2NoYW5nZScsIHJlRm9ybWF0RXhwaXJ5KTtcbiAgICAgIHJldHVybiBfb24oaW5wdXQsICdpbnB1dCcsIHJlRm9ybWF0RXhwaXJ5KTtcbiAgICB9O1xuICAgIHBheWZvcm0uY2FyZE51bWJlcklucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3RDYXJkTnVtYmVyKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgZm9ybWF0Q2FyZE51bWJlcik7XG4gICAgICBfb24oaW5wdXQsICdrZXlkb3duJywgZm9ybWF0QmFja0NhcmROdW1iZXIpO1xuICAgICAgX29uKGlucHV0LCAncGFzdGUnLCByZUZvcm1hdENhcmROdW1iZXIpO1xuICAgICAgX29uKGlucHV0LCAnY2hhbmdlJywgcmVGb3JtYXRDYXJkTnVtYmVyKTtcbiAgICAgIHJldHVybiBfb24oaW5wdXQsICdpbnB1dCcsIHJlRm9ybWF0Q2FyZE51bWJlcik7XG4gICAgfTtcbiAgICBwYXlmb3JtLm51bWVyaWNJbnB1dCA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdwYXN0ZScsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdjaGFuZ2UnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgcmV0dXJuIF9vbihpbnB1dCwgJ2lucHV0JywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICB9O1xuICAgIHBheWZvcm0ucGFyc2VDYXJkRXhwaXJ5ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBtb250aCwgcHJlZml4LCByZWYsIHllYXI7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJyk7XG4gICAgICByZWYgPSB2YWx1ZS5zcGxpdCgnLycsIDIpLCBtb250aCA9IHJlZlswXSwgeWVhciA9IHJlZlsxXTtcbiAgICAgIGlmICgoeWVhciAhPSBudWxsID8geWVhci5sZW5ndGggOiB2b2lkIDApID09PSAyICYmIC9eXFxkKyQvLnRlc3QoeWVhcikpIHtcbiAgICAgICAgcHJlZml4ID0gKG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpO1xuICAgICAgICBwcmVmaXggPSBwcmVmaXgudG9TdHJpbmcoKS5zbGljZSgwLCAyKTtcbiAgICAgICAgeWVhciA9IHByZWZpeCArIHllYXI7XG4gICAgICB9XG4gICAgICBtb250aCA9IHBhcnNlSW50KG1vbnRoLCAxMCk7XG4gICAgICB5ZWFyID0gcGFyc2VJbnQoeWVhciwgMTApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbW9udGg6IG1vbnRoLFxuICAgICAgICB5ZWFyOiB5ZWFyXG4gICAgICB9O1xuICAgIH07XG4gICAgcGF5Zm9ybS52YWxpZGF0ZUNhcmROdW1iZXIgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciBjYXJkLCByZWY7XG4gICAgICBudW0gPSAobnVtICsgJycpLnJlcGxhY2UoL1xccyt8LS9nLCAnJyk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QobnVtKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjYXJkID0gY2FyZEZyb21OdW1iZXIobnVtKTtcbiAgICAgIGlmICghY2FyZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gKHJlZiA9IG51bS5sZW5ndGgsIGluZGV4T2YuY2FsbChjYXJkLmxlbmd0aCwgcmVmKSA+PSAwKSAmJiAoY2FyZC5sdWhuID09PSBmYWxzZSB8fCBsdWhuQ2hlY2sobnVtKSk7XG4gICAgfTtcbiAgICBwYXlmb3JtLnZhbGlkYXRlQ2FyZEV4cGlyeSA9IGZ1bmN0aW9uKG1vbnRoLCB5ZWFyKSB7XG4gICAgICB2YXIgY3VycmVudFRpbWUsIGV4cGlyeSwgcmVmO1xuICAgICAgaWYgKHR5cGVvZiBtb250aCA9PT0gJ29iamVjdCcgJiYgJ21vbnRoJyBpbiBtb250aCkge1xuICAgICAgICByZWYgPSBtb250aCwgbW9udGggPSByZWYubW9udGgsIHllYXIgPSByZWYueWVhcjtcbiAgICAgIH1cbiAgICAgIGlmICghKG1vbnRoICYmIHllYXIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIG1vbnRoID0gU3RyaW5nKG1vbnRoKS50cmltKCk7XG4gICAgICB5ZWFyID0gU3RyaW5nKHllYXIpLnRyaW0oKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChtb250aCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KHllYXIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghKCgxIDw9IG1vbnRoICYmIG1vbnRoIDw9IDEyKSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKHllYXIubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGlmICh5ZWFyIDwgNzApIHtcbiAgICAgICAgICB5ZWFyID0gXCIyMFwiICsgeWVhcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB5ZWFyID0gXCIxOVwiICsgeWVhcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHllYXIubGVuZ3RoICE9PSA0KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGV4cGlyeSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoKTtcbiAgICAgIGN1cnJlbnRUaW1lID0gbmV3IERhdGU7XG4gICAgICBleHBpcnkuc2V0TW9udGgoZXhwaXJ5LmdldE1vbnRoKCkgLSAxKTtcbiAgICAgIGV4cGlyeS5zZXRNb250aChleHBpcnkuZ2V0TW9udGgoKSArIDEsIDEpO1xuICAgICAgcmV0dXJuIGV4cGlyeSA+IGN1cnJlbnRUaW1lO1xuICAgIH07XG4gICAgcGF5Zm9ybS52YWxpZGF0ZUNhcmRDVkMgPSBmdW5jdGlvbihjdmMsIHR5cGUpIHtcbiAgICAgIHZhciBjYXJkLCByZWY7XG4gICAgICBjdmMgPSBTdHJpbmcoY3ZjKS50cmltKCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoY3ZjKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjYXJkID0gY2FyZEZyb21UeXBlKHR5cGUpO1xuICAgICAgaWYgKGNhcmQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gcmVmID0gY3ZjLmxlbmd0aCwgaW5kZXhPZi5jYWxsKGNhcmQuY3ZjTGVuZ3RoLCByZWYpID49IDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY3ZjLmxlbmd0aCA+PSAzICYmIGN2Yy5sZW5ndGggPD0gNDtcbiAgICAgIH1cbiAgICB9O1xuICAgIHBheWZvcm0ucGFyc2VDYXJkVHlwZSA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIHJlZjtcbiAgICAgIGlmICghbnVtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuICgocmVmID0gY2FyZEZyb21OdW1iZXIobnVtKSkgIT0gbnVsbCA/IHJlZi50eXBlIDogdm9pZCAwKSB8fCBudWxsO1xuICAgIH07XG4gICAgcGF5Zm9ybS5mb3JtYXRDYXJkTnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICB2YXIgY2FyZCwgZ3JvdXBzLCByZWYsIHVwcGVyTGVuZ3RoO1xuICAgICAgbnVtID0gcmVwbGFjZUZ1bGxXaWR0aENoYXJzKG51bSk7XG4gICAgICBudW0gPSBudW0ucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcihudW0pO1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHJldHVybiBudW07XG4gICAgICB9XG4gICAgICB1cHBlckxlbmd0aCA9IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdO1xuICAgICAgbnVtID0gbnVtLnNsaWNlKDAsIHVwcGVyTGVuZ3RoKTtcbiAgICAgIGlmIChjYXJkLmZvcm1hdC5nbG9iYWwpIHtcbiAgICAgICAgcmV0dXJuIChyZWYgPSBudW0ubWF0Y2goY2FyZC5mb3JtYXQpKSAhPSBudWxsID8gcmVmLmpvaW4oJyAnKSA6IHZvaWQgMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdyb3VwcyA9IGNhcmQuZm9ybWF0LmV4ZWMobnVtKTtcbiAgICAgICAgaWYgKGdyb3VwcyA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGdyb3Vwcy5zaGlmdCgpO1xuICAgICAgICBncm91cHMgPSBncm91cHMuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICByZXR1cm4gZ3JvdXBzLmpvaW4oJyAnKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHBheWZvcm0uZm9ybWF0Q2FyZEV4cGlyeSA9IGZ1bmN0aW9uKGV4cGlyeSkge1xuICAgICAgdmFyIG1vbiwgcGFydHMsIHNlcCwgeWVhcjtcbiAgICAgIGV4cGlyeSA9IHJlcGxhY2VGdWxsV2lkdGhDaGFycyhleHBpcnkpO1xuICAgICAgcGFydHMgPSBleHBpcnkubWF0Y2goL15cXEQqKFxcZHsxLDJ9KShcXEQrKT8oXFxkezEsNH0pPy8pO1xuICAgICAgaWYgKCFwYXJ0cykge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgICBtb24gPSBwYXJ0c1sxXSB8fCAnJztcbiAgICAgIHNlcCA9IHBhcnRzWzJdIHx8ICcnO1xuICAgICAgeWVhciA9IHBhcnRzWzNdIHx8ICcnO1xuICAgICAgaWYgKHllYXIubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXAgPSAnIC8gJztcbiAgICAgIH0gZWxzZSBpZiAoc2VwID09PSAnIC8nKSB7XG4gICAgICAgIG1vbiA9IG1vbi5zdWJzdHJpbmcoMCwgMSk7XG4gICAgICAgIHNlcCA9ICcnO1xuICAgICAgfSBlbHNlIGlmIChtb24ubGVuZ3RoID09PSAyIHx8IHNlcC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNlcCA9ICcgLyAnO1xuICAgICAgfSBlbHNlIGlmIChtb24ubGVuZ3RoID09PSAxICYmIChtb24gIT09ICcwJyAmJiBtb24gIT09ICcxJykpIHtcbiAgICAgICAgbW9uID0gXCIwXCIgKyBtb247XG4gICAgICAgIHNlcCA9ICcgLyAnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1vbiArIHNlcCArIHllYXI7XG4gICAgfTtcbiAgICByZXR1cm4gcGF5Zm9ybTtcbiAgfSk7XG5cbn0pLmNhbGwodGhpcyk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAvVXNlcnMvYm9iYnkvU2l0ZXMvaGVscGluZ2hhbmRzL2h0ZG9jcy93cC1jb250ZW50L3RoZW1lcy9oZWxwaW5naGFuZHMvdmVuZG9yL2RldmVsb3B3aXRod3Avb21nLWZvcm1zLWF1dGhvcml6ZS1uZXQvbm9kZV9tb2R1bGVzL3BheWZvcm0vZGlzdC9wYXlmb3JtLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdGlmKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdHRocm93IG5ldyBFcnJvcihcImRlZmluZSBjYW5ub3QgYmUgdXNlZCBpbmRpcmVjdFwiKTtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gKHdlYnBhY2spL2J1aWxkaW4vYW1kLWRlZmluZS5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9