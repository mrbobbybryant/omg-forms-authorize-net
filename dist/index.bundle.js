!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=0)}([function(e,t,n){"use strict";var r=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r);document.addEventListener("DOMContentLoaded",function(){(0,a.default)()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e,t,r){if(!1===t&&""==!r.target.value){var a=n.querySelector(".omg-error");e.parentNode.classList.add("error"),a.innerHTML="This card number is not valid"}else""!=r.target.value&&!0!==t||e.parentNode.classList.remove("error")}function t(){var e=l.value,t=c.value,n=a.default.validateCardExpiry(e,t);!1===n&&""==!e&&""==!t?(o.classList.add("error"),i.classList.add("error")):(!0===n||""==e&&""==t)&&(o.classList.remove("error"),i.classList.remove("error"))}if(!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.getElementById("donationForm")))return!1;var n=document.getElementById("omg-forms-card_number"),r=n.querySelector("input"),u=document.querySelectorAll(".donation-expiration-date"),o=document.getElementById("omg-forms-expiration_month"),l=o.querySelector("select"),i=document.getElementById("omg-forms-expiration_year"),c=i.querySelector("select"),d=document.getElementById("omg-forms-card_code"),s=d.querySelector("input");a.default.cardNumberInput(r),a.default.cvcInput(s),r.addEventListener("keyup",function(t){n.classList.contains("error")&&e(r,a.default.validateCardNumber(t.target.value),t)}),s.addEventListener("keyup",function(t){d.classList.contains("error")&&e(s,a.default.validateCardCVC(t.target.value),t)}),r.addEventListener("blur",function(){e(r,a.default.validateCardNumber(event.target.value),event)}),s.addEventListener("blur",function(){e(s,a.default.validateCardCVC(event.target.value),event)}),[].forEach.call(u,function(e){e.querySelector("select").addEventListener("change",function(){t()})})};var r=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){(function(e){(function(){var t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};!function(t,r){void 0!==e&&null!==e?e.exports=r():n(4)("payform",r)}(0,function(){var e,n,r,a,u,o,l,i,c,d,s,f,g,v,h,p,m,y,C,L,b,S,w;return n=function(e){var t,n,r;return null!=e.selectionStart?e.selectionStart:null!=document.selection?(e.focus(),t=document.selection.createRange(),r=e.createTextRange(),n=r.duplicate(),r.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",r),n.text.length):void 0},e=function(e){return function(t){return null==t&&(t=window.event),t.target=t.target||t.srcElement,t.which=t.which||t.keyCode,null==t.preventDefault&&(t.preventDefault=function(){return this.returnValue=!1}),e(t)}},r=function(t,n,r){return r=e(r),null!=t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent("on"+n,r)},h={},o=/(\d{1,4})/g,h.cards=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:o,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:o,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^(5[1-5]|2[2-7])/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:/(\d{1,4})(\d{1,4})?(\d{1,4})?(\d{1,2})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:o,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:o,length:[16],cvcLength:[3],luhn:!0}],a=function(e){var t,n,r,a;for(e=(e+"").replace(/\D/g,""),a=h.cards,n=0,r=a.length;n<r;n++)if(t=a[n],t.pattern.test(e))return t},u=function(e){var t,n,r,a;for(a=h.cards,n=0,r=a.length;n<r;n++)if(t=a[n],t.type===e)return t},v=function(e){var t,n,r,a,u,o;for(u=!0,o=0,n=(e+"").split("").reverse(),r=0,a=n.length;r<a;r++)t=n[r],t=parseInt(t,10),(u=!u)&&(t*=2),t>9&&(t-=9),o+=t;return o%10==0},g=function(e){var t;return!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)||null!=e.selectionStart&&e.selectionStart!==e.selectionEnd},C=function(e){var t,n,r,a,u,o,l,i;for(null==e&&(e=""),r="０１２３４５６７８９",a="0123456789",i="",n=e.split(""),u=0,l=n.length;u<l;u++)t=n[u],o=r.indexOf(t),o>-1&&(t=a[o]),i+=t;return i},m=function(e){var t;if(t=n(e.target),e.target.value=h.formatCardNumber(e.target.value),null!=t&&"change"!==e.type)return e.target.setSelectionRange(t,t)},d=function(e){var t,r,u,o,l,i,c;if(u=String.fromCharCode(e.which),/^\d+$/.test(u)&&(c=e.target.value,t=a(c+u),o=(c.replace(/\D/g,"")+u).length,i=16,t&&(i=t.length[t.length.length-1]),!(o>=i||(r=n(e.target))&&r!==c.length)))return l=t&&"amex"===t.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,l.test(c)?(e.preventDefault(),setTimeout(function(){return e.target.value=c+" "+u})):l.test(c+u)?(e.preventDefault(),setTimeout(function(){return e.target.value=c+u+" "})):void 0},l=function(e){var t,r;if(r=e.target.value,8===e.which&&(!(t=n(e.target))||t===r.length))return/\d\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return e.target.value=r.replace(/\d\s$/,"")})):/\s\d?$/.test(r)?(e.preventDefault(),setTimeout(function(){return e.target.value=r.replace(/\d$/,"")})):void 0},y=function(e){var t;if(t=n(e.target),e.target.value=h.formatCardExpiry(e.target.value),null!=t&&"change"!==e.type)return e.target.setSelectionRange(t,t)},c=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target.value+t,/^\d$/.test(n)&&"0"!==n&&"1"!==n?(e.preventDefault(),setTimeout(function(){return e.target.value="0"+n+" / "})):/^\d\d$/.test(n)?(e.preventDefault(),setTimeout(function(){return e.target.value=n+" / "})):void 0},s=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target.value,/^\d\d$/.test(n)?e.target.value=n+" / ":void 0},f=function(e){var t,n;if("/"===(n=String.fromCharCode(e.which))||" "===n)return t=e.target.value,/^\d$/.test(t)&&"0"!==t?e.target.value="0"+t+" / ":void 0},i=function(e){var t,r;if(r=e.target.value,8===e.which&&(!(t=n(e.target))||t===r.length))return/\d\s\/\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return e.target.value=r.replace(/\d\s\/\s$/,"")})):void 0},p=function(e){var t;if(t=n(e.target),e.target.value=C(e.target.value).replace(/\D/g,"").slice(0,4),null!=t&&"change"!==e.type)return e.target.setSelectionRange(t,t)},w=function(e){var t;if(!(e.metaKey||e.ctrlKey||0===e.which||e.which<33))return t=String.fromCharCode(e.which),/^\d+$/.test(t)?void 0:e.preventDefault()},b=function(e){var t,n,r;if(n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!g(e.target))return r=(e.target.value+n).replace(/\D/g,""),t=a(r),t&&r.length>t.length[t.length.length-1]?e.preventDefault():r.length>16?e.preventDefault():void 0},S=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t)&&!g(e.target))return n=e.target.value+t,n=n.replace(/\D/g,""),n.length>6?e.preventDefault():void 0},L=function(e){var t,n;if(t=String.fromCharCode(e.which),/^\d+$/.test(t)&&!g(e.target))return n=e.target.value+t,n.length>4?e.preventDefault():void 0},h.cvcInput=function(e){return r(e,"keypress",w),r(e,"keypress",L),r(e,"paste",p),r(e,"change",p),r(e,"input",p)},h.expiryInput=function(e){return r(e,"keypress",w),r(e,"keypress",S),r(e,"keypress",c),r(e,"keypress",f),r(e,"keypress",s),r(e,"keydown",i),r(e,"change",y),r(e,"input",y)},h.cardNumberInput=function(e){return r(e,"keypress",w),r(e,"keypress",b),r(e,"keypress",d),r(e,"keydown",l),r(e,"paste",m),r(e,"change",m),r(e,"input",m)},h.numericInput=function(e){return r(e,"keypress",w),r(e,"paste",w),r(e,"change",w),r(e,"input",w)},h.parseCardExpiry=function(e){var t,n,r,a;return e=e.replace(/\s/g,""),r=e.split("/",2),t=r[0],a=r[1],2===(null!=a?a.length:void 0)&&/^\d+$/.test(a)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),a=n+a),t=parseInt(t,10),a=parseInt(a,10),{month:t,year:a}},h.validateCardNumber=function(e){var n,r;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(n=a(e))&&(r=e.length,t.call(n.length,r)>=0&&(!1===n.luhn||v(e))))},h.validateCardExpiry=function(e,t){var n,r,a;return"object"==typeof e&&"month"in e&&(a=e,e=a.month,t=a.year),!(!e||!t)&&(e=String(e).trim(),t=String(t).trim(),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(1<=e&&e<=12&&(2===t.length&&(t=t<70?"20"+t:"19"+t),4===t.length&&(r=new Date(t,e),n=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),r>n)))))},h.validateCardCVC=function(e,n){var r,a;return e=String(e).trim(),!!/^\d+$/.test(e)&&(r=u(n),null!=r?(a=e.length,t.call(r.cvcLength,a)>=0):e.length>=3&&e.length<=4)},h.parseCardType=function(e){var t;return e?(null!=(t=a(e))?t.type:void 0)||null:null},h.formatCardNumber=function(e){var t,n,r,u;return e=C(e),e=e.replace(/\D/g,""),(t=a(e))?(u=t.length[t.length.length-1],e=e.slice(0,u),t.format.global?null!=(r=e.match(t.format))?r.join(" "):void 0:null!=(n=t.format.exec(e))?(n.shift(),n=n.filter(Boolean),n.join(" ")):void 0):e},h.formatCardExpiry=function(e){var t,n,r,a;return e=C(e),(n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",r=n[2]||"",a=n[3]||"",a.length>0?r=" / ":" /"===r?(t=t.substring(0,1),r=""):2===t.length||r.length>0?r=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,r=" / "),t+r+a):""},h})}).call(this)}).call(t,n(3)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXguYnVuZGxlLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAyOTUwMzhjZmUwY2YxNGRiMmIxZiIsIndlYnBhY2s6Ly8vLi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9jYXJkLXZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy9Vc2Vycy9ib2JieS9TaXRlcy9oZWxwaW5naGFuZHMvaHRkb2NzL3dwLWNvbnRlbnQvdGhlbWVzL2hlbHBpbmdoYW5kcy92ZW5kb3IvZGV2ZWxvcHdpdGh3cC9vbWctZm9ybXMtYXV0aG9yaXplLW5ldC9ub2RlX21vZHVsZXMvcGF5Zm9ybS9kaXN0L3BheWZvcm0uanMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vYW1kLWRlZmluZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX2NhcmRWYWxpZGF0aW9uIiwiX2NhcmRWYWxpZGF0aW9uMiIsIm9iaiIsImRlZmF1bHQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2YWx1ZSIsInZhbGlkYXRlQ2FyZElucHV0IiwiZWxlbWVudCIsInZhbGlkIiwiZXZlbnQiLCJ0YXJnZXQiLCJlcnJvck1lc3NhZ2UiLCJjYXJkRmllbGQiLCJxdWVyeVNlbGVjdG9yIiwicGFyZW50Tm9kZSIsImNsYXNzTGlzdCIsImFkZCIsImlubmVySFRNTCIsInJlbW92ZSIsInZhbGlkYXRlQ2FyZERhdGUiLCJtb250aCIsImNhcmRNb250aFNlbGVjdCIsInllYXIiLCJjYXJkWWVhclNlbGVjdCIsInZhbGlkQ2FyZERhdGUiLCJfcGF5Zm9ybTIiLCJ2YWxpZGF0ZUNhcmRFeHBpcnkiLCJjYXJkTW9udGgiLCJjYXJkWWVhciIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImdldEVsZW1lbnRCeUlkIiwiY2FyZElucHV0IiwiY2FyZERhdGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2FyZENvZGUiLCJjYXJkQ29kZUlucHV0IiwiY2FyZE51bWJlcklucHV0IiwiY3ZjSW5wdXQiLCJjb250YWlucyIsInZhbGlkYXRlQ2FyZE51bWJlciIsInZhbGlkYXRlQ2FyZENWQyIsImZvckVhY2giLCJpdGVtIiwiX3BheWZvcm0iLCJpbmRleE9mIiwidGhpcyIsImRlZmluaXRpb24iLCJfZXZlbnROb3JtYWxpemUiLCJfZ2V0Q2FyZXRQb3MiLCJfb24iLCJjYXJkRnJvbU51bWJlciIsImNhcmRGcm9tVHlwZSIsImRlZmF1bHRGb3JtYXQiLCJmb3JtYXRCYWNrQ2FyZE51bWJlciIsImZvcm1hdEJhY2tFeHBpcnkiLCJmb3JtYXRDYXJkRXhwaXJ5IiwiZm9ybWF0Q2FyZE51bWJlciIsImZvcm1hdEZvcndhcmRFeHBpcnkiLCJmb3JtYXRGb3J3YXJkU2xhc2hBbmRTcGFjZSIsImhhc1RleHRTZWxlY3RlZCIsImx1aG5DaGVjayIsInBheWZvcm0iLCJyZUZvcm1hdENWQyIsInJlRm9ybWF0Q2FyZE51bWJlciIsInJlRm9ybWF0RXhwaXJ5IiwicmVwbGFjZUZ1bGxXaWR0aENoYXJzIiwicmVzdHJpY3RDVkMiLCJyZXN0cmljdENhcmROdW1iZXIiLCJyZXN0cmljdEV4cGlyeSIsInJlc3RyaWN0TnVtZXJpYyIsImVsZSIsInIiLCJyYyIsInJlIiwic2VsZWN0aW9uU3RhcnQiLCJzZWxlY3Rpb24iLCJmb2N1cyIsImNyZWF0ZVJhbmdlIiwiY3JlYXRlVGV4dFJhbmdlIiwiZHVwbGljYXRlIiwibW92ZVRvQm9va21hcmsiLCJnZXRCb29rbWFyayIsInNldEVuZFBvaW50IiwidGV4dCIsImxpc3RlbmVyIiwiZSIsIndpbmRvdyIsInNyY0VsZW1lbnQiLCJ3aGljaCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInJldHVyblZhbHVlIiwiYXR0YWNoRXZlbnQiLCJjYXJkcyIsInR5cGUiLCJwYXR0ZXJuIiwiZm9ybWF0IiwiY3ZjTGVuZ3RoIiwibHVobiIsIm51bSIsImNhcmQiLCJsZW4iLCJyZWYiLCJyZXBsYWNlIiwidGVzdCIsImRpZ2l0IiwiZGlnaXRzIiwib2RkIiwic3VtIiwic3BsaXQiLCJyZXZlcnNlIiwicGFyc2VJbnQiLCJzZWxlY3Rpb25FbmQiLCJzdHIiLCJjaGFyIiwiY2hhcnMiLCJmdWxsV2lkdGgiLCJoYWxmV2lkdGgiLCJpZHgiLCJjdXJzb3IiLCJzZXRTZWxlY3Rpb25SYW5nZSIsInVwcGVyTGVuZ3RoIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwic2V0VGltZW91dCIsInZhbCIsInNsaWNlIiwiaW5wdXQiLCJtZXRhS2V5IiwiY3RybEtleSIsImV4cGlyeUlucHV0IiwibnVtZXJpY0lucHV0IiwicGFyc2VDYXJkRXhwaXJ5IiwicHJlZml4IiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwidG9TdHJpbmciLCJjdXJyZW50VGltZSIsImV4cGlyeSIsInRyaW0iLCJzZXRNb250aCIsImdldE1vbnRoIiwiY3ZjIiwicGFyc2VDYXJkVHlwZSIsImdyb3VwcyIsImdsb2JhbCIsIm1hdGNoIiwiam9pbiIsImV4ZWMiLCJzaGlmdCIsImZpbHRlciIsIkJvb2xlYW4iLCJtb24iLCJwYXJ0cyIsInNlcCIsInN1YnN0cmluZyIsIndlYnBhY2tQb2x5ZmlsbCIsImRlcHJlY2F0ZSIsInBhdGhzIiwiY2hpbGRyZW4iLCJFcnJvciJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxH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bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvZGlzdC9cIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF9jYXJkVmFsaWRhdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cbnZhciBfY2FyZFZhbGlkYXRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2FyZFZhbGlkYXRpb24pO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAgICgwLCBfY2FyZFZhbGlkYXRpb24yLmRlZmF1bHQpKCk7XG59KTtcblxuLyoqKi8gfSksXG4vKiAxICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBmb3JtID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9uYXRpb25Gb3JtJyk7XG5cblxuICAgIGlmICghZm9ybSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGNhcmRGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtY2FyZF9udW1iZXInKTtcbiAgICB2YXIgY2FyZElucHV0ID0gY2FyZEZpZWxkLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgdmFyIGNhcmREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRvbmF0aW9uLWV4cGlyYXRpb24tZGF0ZScpO1xuICAgIHZhciBjYXJkTW9udGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb21nLWZvcm1zLWV4cGlyYXRpb25fbW9udGgnKTtcbiAgICB2YXIgY2FyZE1vbnRoU2VsZWN0ID0gY2FyZE1vbnRoLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuICAgIHZhciBjYXJkWWVhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtZXhwaXJhdGlvbl95ZWFyJyk7XG4gICAgdmFyIGNhcmRZZWFyU2VsZWN0ID0gY2FyZFllYXIucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG4gICAgdmFyIGNhcmRDb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29tZy1mb3Jtcy1jYXJkX2NvZGUnKTtcbiAgICB2YXIgY2FyZENvZGVJbnB1dCA9IGNhcmRDb2RlLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG5cbiAgICBfcGF5Zm9ybTIuZGVmYXVsdC5jYXJkTnVtYmVySW5wdXQoY2FyZElucHV0KTtcbiAgICBfcGF5Zm9ybTIuZGVmYXVsdC5jdmNJbnB1dChjYXJkQ29kZUlucHV0KTtcblxuICAgIGNhcmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoY2FyZEZpZWxkLmNsYXNzTGlzdC5jb250YWlucygnZXJyb3InKSkge1xuICAgICAgICAgICAgdmFsaWRhdGVDYXJkSW5wdXQoY2FyZElucHV0LCBfcGF5Zm9ybTIuZGVmYXVsdC52YWxpZGF0ZUNhcmROdW1iZXIoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBjYXJkQ29kZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmIChjYXJkQ29kZS5jbGFzc0xpc3QuY29udGFpbnMoJ2Vycm9yJykpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZElucHV0KGNhcmRDb2RlSW5wdXQsIF9wYXlmb3JtMi5kZWZhdWx0LnZhbGlkYXRlQ2FyZENWQyhldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGNhcmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YWxpZGF0ZUNhcmRJbnB1dChjYXJkSW5wdXQsIF9wYXlmb3JtMi5kZWZhdWx0LnZhbGlkYXRlQ2FyZE51bWJlcihldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgfSk7XG5cbiAgICBjYXJkQ29kZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhbGlkYXRlQ2FyZElucHV0KGNhcmRDb2RlSW5wdXQsIF9wYXlmb3JtMi5kZWZhdWx0LnZhbGlkYXRlQ2FyZENWQyhldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgfSk7XG5cbiAgICBbXS5mb3JFYWNoLmNhbGwoY2FyZERhdGUsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciBzZWxlY3QgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuXG4gICAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUNhcmREYXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVDYXJkSW5wdXQoZWxlbWVudCwgdmFsaWQsIGV2ZW50KSB7XG5cbiAgICAgICAgaWYgKHZhbGlkID09PSBmYWxzZSAmJiAhZXZlbnQudGFyZ2V0LnZhbHVlID09ICcnKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gY2FyZEZpZWxkLnF1ZXJ5U2VsZWN0b3IoJy5vbWctZXJyb3InKTtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlLmlubmVySFRNTCA9ICdUaGlzIGNhcmQgbnVtYmVyIGlzIG5vdCB2YWxpZCc7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09ICcnIHx8IHZhbGlkID09PSB0cnVlKSB7XG4gICAgICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3InKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZhbGlkYXRlQ2FyZERhdGUoKSB7XG4gICAgICAgIHZhciBtb250aCA9IGNhcmRNb250aFNlbGVjdC52YWx1ZTtcbiAgICAgICAgdmFyIHllYXIgPSBjYXJkWWVhclNlbGVjdC52YWx1ZTtcbiAgICAgICAgdmFyIHZhbGlkQ2FyZERhdGUgPSBfcGF5Zm9ybTIuZGVmYXVsdC52YWxpZGF0ZUNhcmRFeHBpcnkobW9udGgsIHllYXIpO1xuXG4gICAgICAgIGlmICh2YWxpZENhcmREYXRlID09PSBmYWxzZSAmJiAhbW9udGggPT0gJycgJiYgIXllYXIgPT0gJycpIHtcbiAgICAgICAgICAgIGNhcmRNb250aC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICAgICAgICAgICAgY2FyZFllYXIuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWxpZENhcmREYXRlID09PSB0cnVlIHx8IG1vbnRoID09ICcnICYmIHllYXIgPT0gJycpIHtcbiAgICAgICAgICAgIGNhcmRNb250aC5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICAgICAgY2FyZFllYXIuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3InKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBfcGF5Zm9ybSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cbnZhciBfcGF5Zm9ybTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wYXlmb3JtKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUpIHtcbi8qXG4gIFBheWZvcm0gSmF2YXNjcmlwdCBMaWJyYXJ5XG5cbiAgVVJMOiBodHRwczovL2dpdGh1Yi5jb20vam9uZGF2aWRqb2huL3BheWZvcm1cbiAgQXV0aG9yOiBKb25hdGhhbiBELiBKb2huc29uIDxtZUBqb25kYXZpZGpvaG4uY29tPlxuICBMaWNlbnNlOiBNSVRcbiAgVmVyc2lvbjogMS4yLjFcbiAqL1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBpbmRleE9mID0gW10uaW5kZXhPZiB8fCBmdW5jdGlvbihpdGVtKSB7IGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsgaWYgKGkgaW4gdGhpcyAmJiB0aGlzW2ldID09PSBpdGVtKSByZXR1cm4gaTsgfSByZXR1cm4gLTE7IH07XG5cbiAgKGZ1bmN0aW9uKG5hbWUsIGRlZmluaXRpb24pIHtcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiBtb2R1bGUuZXhwb3J0cyA9IGRlZmluaXRpb24oKTtcbiAgICB9IGVsc2UgaWYgKHRydWUpIHtcbiAgICAgIHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpKG5hbWUsIGRlZmluaXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpc1tuYW1lXSA9IGRlZmluaXRpb24oKTtcbiAgICB9XG4gIH0pKCdwYXlmb3JtJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIF9ldmVudE5vcm1hbGl6ZSwgX2dldENhcmV0UG9zLCBfb24sIGNhcmRGcm9tTnVtYmVyLCBjYXJkRnJvbVR5cGUsIGRlZmF1bHRGb3JtYXQsIGZvcm1hdEJhY2tDYXJkTnVtYmVyLCBmb3JtYXRCYWNrRXhwaXJ5LCBmb3JtYXRDYXJkRXhwaXJ5LCBmb3JtYXRDYXJkTnVtYmVyLCBmb3JtYXRGb3J3YXJkRXhwaXJ5LCBmb3JtYXRGb3J3YXJkU2xhc2hBbmRTcGFjZSwgaGFzVGV4dFNlbGVjdGVkLCBsdWhuQ2hlY2ssIHBheWZvcm0sIHJlRm9ybWF0Q1ZDLCByZUZvcm1hdENhcmROdW1iZXIsIHJlRm9ybWF0RXhwaXJ5LCByZXBsYWNlRnVsbFdpZHRoQ2hhcnMsIHJlc3RyaWN0Q1ZDLCByZXN0cmljdENhcmROdW1iZXIsIHJlc3RyaWN0RXhwaXJ5LCByZXN0cmljdE51bWVyaWM7XG4gICAgX2dldENhcmV0UG9zID0gZnVuY3Rpb24oZWxlKSB7XG4gICAgICB2YXIgciwgcmMsIHJlO1xuICAgICAgaWYgKGVsZS5zZWxlY3Rpb25TdGFydCAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBlbGUuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LnNlbGVjdGlvbiAhPSBudWxsKSB7XG4gICAgICAgIGVsZS5mb2N1cygpO1xuICAgICAgICByID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgIHJlID0gZWxlLmNyZWF0ZVRleHRSYW5nZSgpO1xuICAgICAgICByYyA9IHJlLmR1cGxpY2F0ZSgpO1xuICAgICAgICByZS5tb3ZlVG9Cb29rbWFyayhyLmdldEJvb2ttYXJrKCkpO1xuICAgICAgICByYy5zZXRFbmRQb2ludCgnRW5kVG9TdGFydCcsIHJlKTtcbiAgICAgICAgcmV0dXJuIHJjLnRleHQubGVuZ3RoO1xuICAgICAgfVxuICAgIH07XG4gICAgX2V2ZW50Tm9ybWFsaXplID0gZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChlID09IG51bGwpIHtcbiAgICAgICAgICBlID0gd2luZG93LmV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGUudGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuICAgICAgICBlLndoaWNoID0gZS53aGljaCB8fCBlLmtleUNvZGU7XG4gICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0ID09IG51bGwpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpc3RlbmVyKGUpO1xuICAgICAgfTtcbiAgICB9O1xuICAgIF9vbiA9IGZ1bmN0aW9uKGVsZSwgZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICBsaXN0ZW5lciA9IF9ldmVudE5vcm1hbGl6ZShsaXN0ZW5lcik7XG4gICAgICBpZiAoZWxlLmFkZEV2ZW50TGlzdGVuZXIgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZWxlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyLCBmYWxzZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZWxlLmF0dGFjaEV2ZW50KFwib25cIiArIGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgfTtcbiAgICBwYXlmb3JtID0ge307XG4gICAgZGVmYXVsdEZvcm1hdCA9IC8oXFxkezEsNH0pL2c7XG4gICAgcGF5Zm9ybS5jYXJkcyA9IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ3Zpc2FlbGVjdHJvbicsXG4gICAgICAgIHBhdHRlcm46IC9eNCgwMjZ8MTc1MDB8NDA1fDUwOHw4NDR8OTFbMzddKS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnbWFlc3RybycsXG4gICAgICAgIHBhdHRlcm46IC9eKDUoMDE4fDBbMjNdfFs2OF0pfDYoMzl8NykpLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTldLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnZm9yYnJ1Z3Nmb3JlbmluZ2VuJyxcbiAgICAgICAgcGF0dGVybjogL142MDAvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2RhbmtvcnQnLFxuICAgICAgICBwYXR0ZXJuOiAvXjUwMTkvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ3Zpc2EnLFxuICAgICAgICBwYXR0ZXJuOiAvXjQvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzEzLCAxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdtYXN0ZXJjYXJkJyxcbiAgICAgICAgcGF0dGVybjogL14oNVsxLTVdfDJbMi03XSkvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2FtZXgnLFxuICAgICAgICBwYXR0ZXJuOiAvXjNbNDddLyxcbiAgICAgICAgZm9ybWF0OiAvKFxcZHsxLDR9KShcXGR7MSw2fSk/KFxcZHsxLDV9KT8vLFxuICAgICAgICBsZW5ndGg6IFsxNV0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzMsIDRdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdkaW5lcnNjbHViJyxcbiAgICAgICAgcGF0dGVybjogL14zWzA2ODldLyxcbiAgICAgICAgZm9ybWF0OiAvKFxcZHsxLDR9KShcXGR7MSw0fSk/KFxcZHsxLDR9KT8oXFxkezEsMn0pPy8sXG4gICAgICAgIGxlbmd0aDogWzE0XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2Rpc2NvdmVyJyxcbiAgICAgICAgcGF0dGVybjogL142KFswNDVdfDIyKS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAndW5pb25wYXknLFxuICAgICAgICBwYXR0ZXJuOiAvXig2Mnw4OCkvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2LCAxNywgMTgsIDE5XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IGZhbHNlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdqY2InLFxuICAgICAgICBwYXR0ZXJuOiAvXjM1LyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9XG4gICAgXTtcbiAgICBjYXJkRnJvbU51bWJlciA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIGNhcmQsIGksIGxlbiwgcmVmO1xuICAgICAgbnVtID0gKG51bSArICcnKS5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgICAgcmVmID0gcGF5Zm9ybS5jYXJkcztcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjYXJkID0gcmVmW2ldO1xuICAgICAgICBpZiAoY2FyZC5wYXR0ZXJuLnRlc3QobnVtKSkge1xuICAgICAgICAgIHJldHVybiBjYXJkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBjYXJkRnJvbVR5cGUgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgICB2YXIgY2FyZCwgaSwgbGVuLCByZWY7XG4gICAgICByZWYgPSBwYXlmb3JtLmNhcmRzO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNhcmQgPSByZWZbaV07XG4gICAgICAgIGlmIChjYXJkLnR5cGUgPT09IHR5cGUpIHtcbiAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgbHVobkNoZWNrID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICB2YXIgZGlnaXQsIGRpZ2l0cywgaSwgbGVuLCBvZGQsIHN1bTtcbiAgICAgIG9kZCA9IHRydWU7XG4gICAgICBzdW0gPSAwO1xuICAgICAgZGlnaXRzID0gKG51bSArICcnKS5zcGxpdCgnJykucmV2ZXJzZSgpO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZGlnaXRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGRpZ2l0ID0gZGlnaXRzW2ldO1xuICAgICAgICBkaWdpdCA9IHBhcnNlSW50KGRpZ2l0LCAxMCk7XG4gICAgICAgIGlmICgob2RkID0gIW9kZCkpIHtcbiAgICAgICAgICBkaWdpdCAqPSAyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkaWdpdCA+IDkpIHtcbiAgICAgICAgICBkaWdpdCAtPSA5O1xuICAgICAgICB9XG4gICAgICAgIHN1bSArPSBkaWdpdDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzdW0gJSAxMCA9PT0gMDtcbiAgICB9O1xuICAgIGhhc1RleHRTZWxlY3RlZCA9IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgdmFyIHJlZjtcbiAgICAgIGlmICgodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmIGRvY3VtZW50ICE9PSBudWxsID8gKHJlZiA9IGRvY3VtZW50LnNlbGVjdGlvbikgIT0gbnVsbCA/IHJlZi5jcmVhdGVSYW5nZSA6IHZvaWQgMCA6IHZvaWQgMCkgIT0gbnVsbCkge1xuICAgICAgICBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gKHRhcmdldC5zZWxlY3Rpb25TdGFydCAhPSBudWxsKSAmJiB0YXJnZXQuc2VsZWN0aW9uU3RhcnQgIT09IHRhcmdldC5zZWxlY3Rpb25FbmQ7XG4gICAgfTtcbiAgICByZXBsYWNlRnVsbFdpZHRoQ2hhcnMgPSBmdW5jdGlvbihzdHIpIHtcbiAgICAgIHZhciBjaGFyLCBjaGFycywgZnVsbFdpZHRoLCBoYWxmV2lkdGgsIGksIGlkeCwgbGVuLCB2YWx1ZTtcbiAgICAgIGlmIChzdHIgPT0gbnVsbCkge1xuICAgICAgICBzdHIgPSAnJztcbiAgICAgIH1cbiAgICAgIGZ1bGxXaWR0aCA9ICdcXHVmZjEwXFx1ZmYxMVxcdWZmMTJcXHVmZjEzXFx1ZmYxNFxcdWZmMTVcXHVmZjE2XFx1ZmYxN1xcdWZmMThcXHVmZjE5JztcbiAgICAgIGhhbGZXaWR0aCA9ICcwMTIzNDU2Nzg5JztcbiAgICAgIHZhbHVlID0gJyc7XG4gICAgICBjaGFycyA9IHN0ci5zcGxpdCgnJyk7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBjaGFycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjaGFyID0gY2hhcnNbaV07XG4gICAgICAgIGlkeCA9IGZ1bGxXaWR0aC5pbmRleE9mKGNoYXIpO1xuICAgICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgICBjaGFyID0gaGFsZldpZHRoW2lkeF07XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWUgKz0gY2hhcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9O1xuICAgIHJlRm9ybWF0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjdXJzb3I7XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgZS50YXJnZXQudmFsdWUgPSBwYXlmb3JtLmZvcm1hdENhcmROdW1iZXIoZS50YXJnZXQudmFsdWUpO1xuICAgICAgaWYgKChjdXJzb3IgIT0gbnVsbCkgJiYgZS50eXBlICE9PSAnY2hhbmdlJykge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yLCBjdXJzb3IpO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjYXJkLCBjdXJzb3IsIGRpZ2l0LCBsZW5ndGgsIHJlLCB1cHBlckxlbmd0aCwgdmFsdWU7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICBjYXJkID0gY2FyZEZyb21OdW1iZXIodmFsdWUgKyBkaWdpdCk7XG4gICAgICBsZW5ndGggPSAodmFsdWUucmVwbGFjZSgvXFxEL2csICcnKSArIGRpZ2l0KS5sZW5ndGg7XG4gICAgICB1cHBlckxlbmd0aCA9IDE2O1xuICAgICAgaWYgKGNhcmQpIHtcbiAgICAgICAgdXBwZXJMZW5ndGggPSBjYXJkLmxlbmd0aFtjYXJkLmxlbmd0aC5sZW5ndGggLSAxXTtcbiAgICAgIH1cbiAgICAgIGlmIChsZW5ndGggPj0gdXBwZXJMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGlmIChjdXJzb3IgJiYgY3Vyc29yICE9PSB2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGNhcmQgJiYgY2FyZC50eXBlID09PSAnYW1leCcpIHtcbiAgICAgICAgcmUgPSAvXihcXGR7NH18XFxkezR9XFxzXFxkezZ9KSQvO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmUgPSAvKD86XnxcXHMpKFxcZHs0fSkkLztcbiAgICAgIH1cbiAgICAgIGlmIChyZS50ZXN0KHZhbHVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbHVlICsgXCIgXCIgKyBkaWdpdDtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHJlLnRlc3QodmFsdWUgKyBkaWdpdCkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSAodmFsdWUgKyBkaWdpdCkgKyBcIiBcIjtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRCYWNrQ2FyZE51bWJlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjdXJzb3IsIHZhbHVlO1xuICAgICAgdmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgIGlmIChlLndoaWNoICE9PSA4KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBpZiAoY3Vyc29yICYmIGN1cnNvciAhPT0gdmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICgvXFxkXFxzJC8udGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXGRcXHMkLywgJycpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoL1xcc1xcZD8kLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xcZCQvLCAnJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVGb3JtYXRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yO1xuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGUudGFyZ2V0LnZhbHVlID0gcGF5Zm9ybS5mb3JtYXRDYXJkRXhwaXJ5KGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgIGlmICgoY3Vyc29yICE9IG51bGwpICYmIGUudHlwZSAhPT0gJ2NoYW5nZScpIHtcbiAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGN1cnNvciwgY3Vyc29yKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdENhcmRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgZGlnaXQsIHZhbDtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsID0gZS50YXJnZXQudmFsdWUgKyBkaWdpdDtcbiAgICAgIGlmICgvXlxcZCQvLnRlc3QodmFsKSAmJiAodmFsICE9PSAnMCcgJiYgdmFsICE9PSAnMScpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gXCIwXCIgKyB2YWwgKyBcIiAvIFwiO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoL15cXGRcXGQkLy50ZXN0KHZhbCkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWwgKyBcIiAvIFwiO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdEZvcndhcmRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgZGlnaXQsIHZhbDtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsID0gZS50YXJnZXQudmFsdWU7XG4gICAgICBpZiAoL15cXGRcXGQkLy50ZXN0KHZhbCkpIHtcbiAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsICsgXCIgLyBcIjtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdEZvcndhcmRTbGFzaEFuZFNwYWNlID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHZhbCwgd2hpY2g7XG4gICAgICB3aGljaCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoISh3aGljaCA9PT0gJy8nIHx8IHdoaWNoID09PSAnICcpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKC9eXFxkJC8udGVzdCh2YWwpICYmIHZhbCAhPT0gJzAnKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IFwiMFwiICsgdmFsICsgXCIgLyBcIjtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdEJhY2tFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yLCB2YWx1ZTtcbiAgICAgIHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICBpZiAoZS53aGljaCAhPT0gOCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgaWYgKGN1cnNvciAmJiBjdXJzb3IgIT09IHZhbHVlLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoL1xcZFxcc1xcL1xccyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxkXFxzXFwvXFxzJC8sICcnKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZUZvcm1hdENWQyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjdXJzb3I7XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgZS50YXJnZXQudmFsdWUgPSByZXBsYWNlRnVsbFdpZHRoQ2hhcnMoZS50YXJnZXQudmFsdWUpLnJlcGxhY2UoL1xcRC9nLCAnJykuc2xpY2UoMCwgNCk7XG4gICAgICBpZiAoKGN1cnNvciAhPSBudWxsKSAmJiBlLnR5cGUgIT09ICdjaGFuZ2UnKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3IsIGN1cnNvcik7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdE51bWVyaWMgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgaW5wdXQ7XG4gICAgICBpZiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZS53aGljaCA9PT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZS53aGljaCA8IDMzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlucHV0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChpbnB1dCkpIHtcbiAgICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlc3RyaWN0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjYXJkLCBkaWdpdCwgdmFsdWU7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQoZS50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbHVlID0gKGUudGFyZ2V0LnZhbHVlICsgZGlnaXQpLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gICAgICBjYXJkID0gY2FyZEZyb21OdW1iZXIodmFsdWUpO1xuICAgICAgaWYgKGNhcmQgJiYgdmFsdWUubGVuZ3RoID4gY2FyZC5sZW5ndGhbY2FyZC5sZW5ndGgubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUubGVuZ3RoID4gMTYpIHtcbiAgICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlc3RyaWN0RXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGRpZ2l0LCB2YWx1ZTtcbiAgICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGhhc1RleHRTZWxlY3RlZChlLnRhcmdldCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSBlLnRhcmdldC52YWx1ZSArIGRpZ2l0O1xuICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDYpIHtcbiAgICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlc3RyaWN0Q1ZDID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGRpZ2l0LCB2YWw7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQoZS50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbCA9IGUudGFyZ2V0LnZhbHVlICsgZGlnaXQ7XG4gICAgICBpZiAodmFsLmxlbmd0aCA+IDQpIHtcbiAgICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHBheWZvcm0uY3ZjSW5wdXQgPSBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdENWQyk7XG4gICAgICBfb24oaW5wdXQsICdwYXN0ZScsIHJlRm9ybWF0Q1ZDKTtcbiAgICAgIF9vbihpbnB1dCwgJ2NoYW5nZScsIHJlRm9ybWF0Q1ZDKTtcbiAgICAgIHJldHVybiBfb24oaW5wdXQsICdpbnB1dCcsIHJlRm9ybWF0Q1ZDKTtcbiAgICB9O1xuICAgIHBheWZvcm0uZXhwaXJ5SW5wdXQgPSBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdEV4cGlyeSk7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIGZvcm1hdENhcmRFeHBpcnkpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCBmb3JtYXRGb3J3YXJkU2xhc2hBbmRTcGFjZSk7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIGZvcm1hdEZvcndhcmRFeHBpcnkpO1xuICAgICAgX29uKGlucHV0LCAna2V5ZG93bicsIGZvcm1hdEJhY2tFeHBpcnkpO1xuICAgICAgX29uKGlucHV0LCAnY2hhbmdlJywgcmVGb3JtYXRFeHBpcnkpO1xuICAgICAgcmV0dXJuIF9vbihpbnB1dCwgJ2lucHV0JywgcmVGb3JtYXRFeHBpcnkpO1xuICAgIH07XG4gICAgcGF5Zm9ybS5jYXJkTnVtYmVySW5wdXQgPSBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCByZXN0cmljdENhcmROdW1iZXIpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCBmb3JtYXRDYXJkTnVtYmVyKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleWRvd24nLCBmb3JtYXRCYWNrQ2FyZE51bWJlcik7XG4gICAgICBfb24oaW5wdXQsICdwYXN0ZScsIHJlRm9ybWF0Q2FyZE51bWJlcik7XG4gICAgICBfb24oaW5wdXQsICdjaGFuZ2UnLCByZUZvcm1hdENhcmROdW1iZXIpO1xuICAgICAgcmV0dXJuIF9vbihpbnB1dCwgJ2lucHV0JywgcmVGb3JtYXRDYXJkTnVtYmVyKTtcbiAgICB9O1xuICAgIHBheWZvcm0ubnVtZXJpY0lucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ3Bhc3RlJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2NoYW5nZScsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICByZXR1cm4gX29uKGlucHV0LCAnaW5wdXQnLCByZXN0cmljdE51bWVyaWMpO1xuICAgIH07XG4gICAgcGF5Zm9ybS5wYXJzZUNhcmRFeHBpcnkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG1vbnRoLCBwcmVmaXgsIHJlZiwgeWVhcjtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgICAgIHJlZiA9IHZhbHVlLnNwbGl0KCcvJywgMiksIG1vbnRoID0gcmVmWzBdLCB5ZWFyID0gcmVmWzFdO1xuICAgICAgaWYgKCh5ZWFyICE9IG51bGwgPyB5ZWFyLmxlbmd0aCA6IHZvaWQgMCkgPT09IDIgJiYgL15cXGQrJC8udGVzdCh5ZWFyKSkge1xuICAgICAgICBwcmVmaXggPSAobmV3IERhdGUpLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIHByZWZpeCA9IHByZWZpeC50b1N0cmluZygpLnNsaWNlKDAsIDIpO1xuICAgICAgICB5ZWFyID0gcHJlZml4ICsgeWVhcjtcbiAgICAgIH1cbiAgICAgIG1vbnRoID0gcGFyc2VJbnQobW9udGgsIDEwKTtcbiAgICAgIHllYXIgPSBwYXJzZUludCh5ZWFyLCAxMCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtb250aDogbW9udGgsXG4gICAgICAgIHllYXI6IHllYXJcbiAgICAgIH07XG4gICAgfTtcbiAgICBwYXlmb3JtLnZhbGlkYXRlQ2FyZE51bWJlciA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIGNhcmQsIHJlZjtcbiAgICAgIG51bSA9IChudW0gKyAnJykucmVwbGFjZSgvXFxzK3wtL2csICcnKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChudW0pKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcihudW0pO1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAocmVmID0gbnVtLmxlbmd0aCwgaW5kZXhPZi5jYWxsKGNhcmQubGVuZ3RoLCByZWYpID49IDApICYmIChjYXJkLmx1aG4gPT09IGZhbHNlIHx8IGx1aG5DaGVjayhudW0pKTtcbiAgICB9O1xuICAgIHBheWZvcm0udmFsaWRhdGVDYXJkRXhwaXJ5ID0gZnVuY3Rpb24obW9udGgsIHllYXIpIHtcbiAgICAgIHZhciBjdXJyZW50VGltZSwgZXhwaXJ5LCByZWY7XG4gICAgICBpZiAodHlwZW9mIG1vbnRoID09PSAnb2JqZWN0JyAmJiAnbW9udGgnIGluIG1vbnRoKSB7XG4gICAgICAgIHJlZiA9IG1vbnRoLCBtb250aCA9IHJlZi5tb250aCwgeWVhciA9IHJlZi55ZWFyO1xuICAgICAgfVxuICAgICAgaWYgKCEobW9udGggJiYgeWVhcikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgbW9udGggPSBTdHJpbmcobW9udGgpLnRyaW0oKTtcbiAgICAgIHllYXIgPSBTdHJpbmcoeWVhcikudHJpbSgpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KG1vbnRoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoeWVhcikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCEoKDEgPD0gbW9udGggJiYgbW9udGggPD0gMTIpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoeWVhci5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgaWYgKHllYXIgPCA3MCkge1xuICAgICAgICAgIHllYXIgPSBcIjIwXCIgKyB5ZWFyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHllYXIgPSBcIjE5XCIgKyB5ZWFyO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoeWVhci5sZW5ndGggIT09IDQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgZXhwaXJ5ID0gbmV3IERhdGUoeWVhciwgbW9udGgpO1xuICAgICAgY3VycmVudFRpbWUgPSBuZXcgRGF0ZTtcbiAgICAgIGV4cGlyeS5zZXRNb250aChleHBpcnkuZ2V0TW9udGgoKSAtIDEpO1xuICAgICAgZXhwaXJ5LnNldE1vbnRoKGV4cGlyeS5nZXRNb250aCgpICsgMSwgMSk7XG4gICAgICByZXR1cm4gZXhwaXJ5ID4gY3VycmVudFRpbWU7XG4gICAgfTtcbiAgICBwYXlmb3JtLnZhbGlkYXRlQ2FyZENWQyA9IGZ1bmN0aW9uKGN2YywgdHlwZSkge1xuICAgICAgdmFyIGNhcmQsIHJlZjtcbiAgICAgIGN2YyA9IFN0cmluZyhjdmMpLnRyaW0oKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChjdmMpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNhcmQgPSBjYXJkRnJvbVR5cGUodHlwZSk7XG4gICAgICBpZiAoY2FyZCAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZWYgPSBjdmMubGVuZ3RoLCBpbmRleE9mLmNhbGwoY2FyZC5jdmNMZW5ndGgsIHJlZikgPj0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBjdmMubGVuZ3RoID49IDMgJiYgY3ZjLmxlbmd0aCA8PSA0O1xuICAgICAgfVxuICAgIH07XG4gICAgcGF5Zm9ybS5wYXJzZUNhcmRUeXBlID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICB2YXIgcmVmO1xuICAgICAgaWYgKCFudW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gKChyZWYgPSBjYXJkRnJvbU51bWJlcihudW0pKSAhPSBudWxsID8gcmVmLnR5cGUgOiB2b2lkIDApIHx8IG51bGw7XG4gICAgfTtcbiAgICBwYXlmb3JtLmZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciBjYXJkLCBncm91cHMsIHJlZiwgdXBwZXJMZW5ndGg7XG4gICAgICBudW0gPSByZXBsYWNlRnVsbFdpZHRoQ2hhcnMobnVtKTtcbiAgICAgIG51bSA9IG51bS5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKG51bSk7XG4gICAgICBpZiAoIWNhcmQpIHtcbiAgICAgICAgcmV0dXJuIG51bTtcbiAgICAgIH1cbiAgICAgIHVwcGVyTGVuZ3RoID0gY2FyZC5sZW5ndGhbY2FyZC5sZW5ndGgubGVuZ3RoIC0gMV07XG4gICAgICBudW0gPSBudW0uc2xpY2UoMCwgdXBwZXJMZW5ndGgpO1xuICAgICAgaWYgKGNhcmQuZm9ybWF0Lmdsb2JhbCkge1xuICAgICAgICByZXR1cm4gKHJlZiA9IG51bS5tYXRjaChjYXJkLmZvcm1hdCkpICE9IG51bGwgPyByZWYuam9pbignICcpIDogdm9pZCAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ3JvdXBzID0gY2FyZC5mb3JtYXQuZXhlYyhudW0pO1xuICAgICAgICBpZiAoZ3JvdXBzID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZ3JvdXBzLnNoaWZ0KCk7XG4gICAgICAgIGdyb3VwcyA9IGdyb3Vwcy5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIHJldHVybiBncm91cHMuam9pbignICcpO1xuICAgICAgfVxuICAgIH07XG4gICAgcGF5Zm9ybS5mb3JtYXRDYXJkRXhwaXJ5ID0gZnVuY3Rpb24oZXhwaXJ5KSB7XG4gICAgICB2YXIgbW9uLCBwYXJ0cywgc2VwLCB5ZWFyO1xuICAgICAgZXhwaXJ5ID0gcmVwbGFjZUZ1bGxXaWR0aENoYXJzKGV4cGlyeSk7XG4gICAgICBwYXJ0cyA9IGV4cGlyeS5tYXRjaCgvXlxcRCooXFxkezEsMn0pKFxcRCspPyhcXGR7MSw0fSk/Lyk7XG4gICAgICBpZiAoIXBhcnRzKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICAgIG1vbiA9IHBhcnRzWzFdIHx8ICcnO1xuICAgICAgc2VwID0gcGFydHNbMl0gfHwgJyc7XG4gICAgICB5ZWFyID0gcGFydHNbM10gfHwgJyc7XG4gICAgICBpZiAoeWVhci5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNlcCA9ICcgLyAnO1xuICAgICAgfSBlbHNlIGlmIChzZXAgPT09ICcgLycpIHtcbiAgICAgICAgbW9uID0gbW9uLnN1YnN0cmluZygwLCAxKTtcbiAgICAgICAgc2VwID0gJyc7XG4gICAgICB9IGVsc2UgaWYgKG1vbi5sZW5ndGggPT09IDIgfHwgc2VwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2VwID0gJyAvICc7XG4gICAgICB9IGVsc2UgaWYgKG1vbi5sZW5ndGggPT09IDEgJiYgKG1vbiAhPT0gJzAnICYmIG1vbiAhPT0gJzEnKSkge1xuICAgICAgICBtb24gPSBcIjBcIiArIG1vbjtcbiAgICAgICAgc2VwID0gJyAvICc7XG4gICAgICB9XG4gICAgICByZXR1cm4gbW9uICsgc2VwICsgeWVhcjtcbiAgICB9O1xuICAgIHJldHVybiBwYXlmb3JtO1xuICB9KTtcblxufSkuY2FsbCh0aGlzKTtcblxuLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMykobW9kdWxlKSkpXG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xyXG5cdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XHJcblx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcclxuXHRcdG1vZHVsZS5wYXRocyA9IFtdO1xyXG5cdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XHJcblx0XHRpZighbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwibG9hZGVkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmw7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJpZFwiLCB7XHJcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXHJcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xyXG5cdH1cclxuXHRyZXR1cm4gbW9kdWxlO1xyXG59O1xyXG5cblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XHJcblx0dGhyb3cgbmV3IEVycm9yKFwiZGVmaW5lIGNhbm5vdCBiZSB1c2VkIGluZGlyZWN0XCIpO1xyXG59O1xyXG5cblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBpbmRleC5idW5kbGUuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvZGlzdC9cIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAyOTUwMzhjZmUwY2YxNGRiMmIxZiIsImltcG9ydCBjYXJkVmFsaWRhdGlvbiBmcm9tICcuL2NhcmQtdmFsaWRhdGlvbic7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgIGNhcmRWYWxpZGF0aW9uKCk7XG59ICk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9pbmRleC5qcyIsImltcG9ydCBwYXlmb3JtIGZyb20gJ3BheWZvcm0nO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiggZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnZG9uYXRpb25Gb3JtJyApICkge1xuXG4gICAgaWYgKCAhZm9ybSApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBjYXJkRmllbGQgID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtY2FyZF9udW1iZXInKTtcbiAgICBsZXQgY2FyZElucHV0ICA9ICBjYXJkRmllbGQucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICBsZXQgY2FyZERhdGUgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kb25hdGlvbi1leHBpcmF0aW9uLWRhdGUnKTtcbiAgICBsZXQgY2FyZE1vbnRoICA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb21nLWZvcm1zLWV4cGlyYXRpb25fbW9udGgnKTtcbiAgICBsZXQgY2FyZE1vbnRoU2VsZWN0ID0gY2FyZE1vbnRoLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuICAgIGxldCBjYXJkWWVhciAgID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbWctZm9ybXMtZXhwaXJhdGlvbl95ZWFyJyk7XG4gICAgbGV0IGNhcmRZZWFyU2VsZWN0ID0gY2FyZFllYXIucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG4gICAgbGV0IGNhcmRDb2RlICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb21nLWZvcm1zLWNhcmRfY29kZScpO1xuICAgIGxldCBjYXJkQ29kZUlucHV0ID0gY2FyZENvZGUucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcblxuICAgIHBheWZvcm0uY2FyZE51bWJlcklucHV0KGNhcmRJbnB1dCk7XG4gICAgcGF5Zm9ybS5jdmNJbnB1dChjYXJkQ29kZUlucHV0KTtcblxuICAgIGNhcmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgaWYgKCBjYXJkRmllbGQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlcnJvcicpICkge1xuICAgICAgICAgICAgdmFsaWRhdGVDYXJkSW5wdXQoY2FyZElucHV0LCBwYXlmb3JtLnZhbGlkYXRlQ2FyZE51bWJlcihldmVudC50YXJnZXQudmFsdWUpLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGNhcmRDb2RlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCl7XG4gICAgICAgIGlmICggY2FyZENvZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdlcnJvcicpICkge1xuICAgICAgICAgICAgdmFsaWRhdGVDYXJkSW5wdXQoY2FyZENvZGVJbnB1dCwgcGF5Zm9ybS52YWxpZGF0ZUNhcmRDVkMoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBjYXJkSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFsaWRhdGVDYXJkSW5wdXQoY2FyZElucHV0LCBwYXlmb3JtLnZhbGlkYXRlQ2FyZE51bWJlcihldmVudC50YXJnZXQudmFsdWUpLCBldmVudClcbiAgICB9KTtcblxuICAgIGNhcmRDb2RlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFsaWRhdGVDYXJkSW5wdXQoY2FyZENvZGVJbnB1dCwgcGF5Zm9ybS52YWxpZGF0ZUNhcmRDVkMoZXZlbnQudGFyZ2V0LnZhbHVlKSwgZXZlbnQpXG4gICAgfSk7XG5cbiAgICBbXS5mb3JFYWNoLmNhbGwoIGNhcmREYXRlLCBmdW5jdGlvbiggaXRlbSApIHtcbiAgICAgICAgbGV0IHNlbGVjdCA9IGl0ZW0ucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG5cbiAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlQ2FyZERhdGUoKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHZhbGlkYXRlQ2FyZElucHV0KGVsZW1lbnQsIHZhbGlkLCBldmVudCkge1xuXG4gICAgICAgIGlmICggdmFsaWQgPT09IGZhbHNlICYmICFldmVudC50YXJnZXQudmFsdWUgPT0gJycgKSB7XG4gICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gY2FyZEZpZWxkLnF1ZXJ5U2VsZWN0b3IoJy5vbWctZXJyb3InKTtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlLmlubmVySFRNTCA9ICdUaGlzIGNhcmQgbnVtYmVyIGlzIG5vdCB2YWxpZCc7XG5cbiAgICAgICAgfSBlbHNlIGlmICggZXZlbnQudGFyZ2V0LnZhbHVlID09ICcnIHx8IHZhbGlkID09PSB0cnVlICApIHtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVDYXJkRGF0ZSgpIHtcbiAgICAgICAgbGV0IG1vbnRoID0gY2FyZE1vbnRoU2VsZWN0LnZhbHVlO1xuICAgICAgICBsZXQgeWVhciAgPSBjYXJkWWVhclNlbGVjdC52YWx1ZTtcbiAgICAgICAgbGV0IHZhbGlkQ2FyZERhdGUgPSBwYXlmb3JtLnZhbGlkYXRlQ2FyZEV4cGlyeSggbW9udGgsIHllYXIpO1xuXG4gICAgICAgIGlmICggdmFsaWRDYXJkRGF0ZSA9PT0gZmFsc2UgJiYgIW1vbnRoID09ICcnICYmICF5ZWFyID09ICcnICkge1xuICAgICAgICAgICAgY2FyZE1vbnRoLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgICAgICAgICBjYXJkWWVhci5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoIHZhbGlkQ2FyZERhdGUgPT09IHRydWUgfHwgbW9udGggPT0gJycgJiYgeWVhciA9PSAnJyAgICkge1xuICAgICAgICAgICAgY2FyZE1vbnRoLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XG4gICAgICAgICAgICBjYXJkWWVhci5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vY2FyZC12YWxpZGF0aW9uLmpzIiwiXG4vKlxuICBQYXlmb3JtIEphdmFzY3JpcHQgTGlicmFyeVxuXG4gIFVSTDogaHR0cHM6Ly9naXRodWIuY29tL2pvbmRhdmlkam9obi9wYXlmb3JtXG4gIEF1dGhvcjogSm9uYXRoYW4gRC4gSm9obnNvbiA8bWVAam9uZGF2aWRqb2huLmNvbT5cbiAgTGljZW5zZTogTUlUXG4gIFZlcnNpb246IDEuMi4xXG4gKi9cblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgaW5kZXhPZiA9IFtdLmluZGV4T2YgfHwgZnVuY3Rpb24oaXRlbSkgeyBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7IGlmIChpIGluIHRoaXMgJiYgdGhpc1tpXSA9PT0gaXRlbSkgcmV0dXJuIGk7IH0gcmV0dXJuIC0xOyB9O1xuXG4gIChmdW5jdGlvbihuYW1lLCBkZWZpbml0aW9uKSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gbW9kdWxlLmV4cG9ydHMgPSBkZWZpbml0aW9uKCk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBkZWZpbmUuYW1kID09PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIGRlZmluZShuYW1lLCBkZWZpbml0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXNbbmFtZV0gPSBkZWZpbml0aW9uKCk7XG4gICAgfVxuICB9KSgncGF5Zm9ybScsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBfZXZlbnROb3JtYWxpemUsIF9nZXRDYXJldFBvcywgX29uLCBjYXJkRnJvbU51bWJlciwgY2FyZEZyb21UeXBlLCBkZWZhdWx0Rm9ybWF0LCBmb3JtYXRCYWNrQ2FyZE51bWJlciwgZm9ybWF0QmFja0V4cGlyeSwgZm9ybWF0Q2FyZEV4cGlyeSwgZm9ybWF0Q2FyZE51bWJlciwgZm9ybWF0Rm9yd2FyZEV4cGlyeSwgZm9ybWF0Rm9yd2FyZFNsYXNoQW5kU3BhY2UsIGhhc1RleHRTZWxlY3RlZCwgbHVobkNoZWNrLCBwYXlmb3JtLCByZUZvcm1hdENWQywgcmVGb3JtYXRDYXJkTnVtYmVyLCByZUZvcm1hdEV4cGlyeSwgcmVwbGFjZUZ1bGxXaWR0aENoYXJzLCByZXN0cmljdENWQywgcmVzdHJpY3RDYXJkTnVtYmVyLCByZXN0cmljdEV4cGlyeSwgcmVzdHJpY3ROdW1lcmljO1xuICAgIF9nZXRDYXJldFBvcyA9IGZ1bmN0aW9uKGVsZSkge1xuICAgICAgdmFyIHIsIHJjLCByZTtcbiAgICAgIGlmIChlbGUuc2VsZWN0aW9uU3RhcnQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZWxlLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICBlbGUuZm9jdXMoKTtcbiAgICAgICAgciA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICAgICAgICByZSA9IGVsZS5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICAgICAgcmMgPSByZS5kdXBsaWNhdGUoKTtcbiAgICAgICAgcmUubW92ZVRvQm9va21hcmsoci5nZXRCb29rbWFyaygpKTtcbiAgICAgICAgcmMuc2V0RW5kUG9pbnQoJ0VuZFRvU3RhcnQnLCByZSk7XG4gICAgICAgIHJldHVybiByYy50ZXh0Lmxlbmd0aDtcbiAgICAgIH1cbiAgICB9O1xuICAgIF9ldmVudE5vcm1hbGl6ZSA9IGZ1bmN0aW9uKGxpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoZSA9PSBudWxsKSB7XG4gICAgICAgICAgZSA9IHdpbmRvdy5ldmVudDtcbiAgICAgICAgfVxuICAgICAgICBlLnRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICAgICAgZS53aGljaCA9IGUud2hpY2ggfHwgZS5rZXlDb2RlO1xuICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCA9PSBudWxsKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0ZW5lcihlKTtcbiAgICAgIH07XG4gICAgfTtcbiAgICBfb24gPSBmdW5jdGlvbihlbGUsIGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgbGlzdGVuZXIgPSBfZXZlbnROb3JtYWxpemUobGlzdGVuZXIpO1xuICAgICAgaWYgKGVsZS5hZGRFdmVudExpc3RlbmVyICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGVsZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGVsZS5hdHRhY2hFdmVudChcIm9uXCIgKyBldmVudCwgbGlzdGVuZXIpO1xuICAgICAgfVxuICAgIH07XG4gICAgcGF5Zm9ybSA9IHt9O1xuICAgIGRlZmF1bHRGb3JtYXQgPSAvKFxcZHsxLDR9KS9nO1xuICAgIHBheWZvcm0uY2FyZHMgPSBbXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICd2aXNhZWxlY3Ryb24nLFxuICAgICAgICBwYXR0ZXJuOiAvXjQoMDI2fDE3NTAwfDQwNXw1MDh8ODQ0fDkxWzM3XSkvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ21hZXN0cm8nLFxuICAgICAgICBwYXR0ZXJuOiAvXig1KDAxOHwwWzIzXXxbNjhdKXw2KDM5fDcpKS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ2ZvcmJydWdzZm9yZW5pbmdlbicsXG4gICAgICAgIHBhdHRlcm46IC9eNjAwLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdkYW5rb3J0JyxcbiAgICAgICAgcGF0dGVybjogL141MDE5LyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICd2aXNhJyxcbiAgICAgICAgcGF0dGVybjogL140LyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxMywgMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnbWFzdGVyY2FyZCcsXG4gICAgICAgIHBhdHRlcm46IC9eKDVbMS01XXwyWzItN10pLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdhbWV4JyxcbiAgICAgICAgcGF0dGVybjogL14zWzQ3XS8sXG4gICAgICAgIGZvcm1hdDogLyhcXGR7MSw0fSkoXFxkezEsNn0pPyhcXGR7MSw1fSk/LyxcbiAgICAgICAgbGVuZ3RoOiBbMTVdLFxuICAgICAgICBjdmNMZW5ndGg6IFszLCA0XSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnZGluZXJzY2x1YicsXG4gICAgICAgIHBhdHRlcm46IC9eM1swNjg5XS8sXG4gICAgICAgIGZvcm1hdDogLyhcXGR7MSw0fSkoXFxkezEsNH0pPyhcXGR7MSw0fSk/KFxcZHsxLDJ9KT8vLFxuICAgICAgICBsZW5ndGg6IFsxNF0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiB0cnVlXG4gICAgICB9LCB7XG4gICAgICAgIHR5cGU6ICdkaXNjb3ZlcicsXG4gICAgICAgIHBhdHRlcm46IC9eNihbMDQ1XXwyMikvLFxuICAgICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgIGxlbmd0aDogWzE2XSxcbiAgICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICAgIGx1aG46IHRydWVcbiAgICAgIH0sIHtcbiAgICAgICAgdHlwZTogJ3VuaW9ucGF5JyxcbiAgICAgICAgcGF0dGVybjogL14oNjJ8ODgpLyxcbiAgICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgICBsZW5ndGg6IFsxNiwgMTcsIDE4LCAxOV0sXG4gICAgICAgIGN2Y0xlbmd0aDogWzNdLFxuICAgICAgICBsdWhuOiBmYWxzZVxuICAgICAgfSwge1xuICAgICAgICB0eXBlOiAnamNiJyxcbiAgICAgICAgcGF0dGVybjogL14zNS8sXG4gICAgICAgIGZvcm1hdDogZGVmYXVsdEZvcm1hdCxcbiAgICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgICAgbHVobjogdHJ1ZVxuICAgICAgfVxuICAgIF07XG4gICAgY2FyZEZyb21OdW1iZXIgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciBjYXJkLCBpLCBsZW4sIHJlZjtcbiAgICAgIG51bSA9IChudW0gKyAnJykucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIHJlZiA9IHBheWZvcm0uY2FyZHM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2FyZCA9IHJlZltpXTtcbiAgICAgICAgaWYgKGNhcmQucGF0dGVybi50ZXN0KG51bSkpIHtcbiAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgY2FyZEZyb21UeXBlID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgdmFyIGNhcmQsIGksIGxlbiwgcmVmO1xuICAgICAgcmVmID0gcGF5Zm9ybS5jYXJkcztcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjYXJkID0gcmVmW2ldO1xuICAgICAgICBpZiAoY2FyZC50eXBlID09PSB0eXBlKSB7XG4gICAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIGx1aG5DaGVjayA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIGRpZ2l0LCBkaWdpdHMsIGksIGxlbiwgb2RkLCBzdW07XG4gICAgICBvZGQgPSB0cnVlO1xuICAgICAgc3VtID0gMDtcbiAgICAgIGRpZ2l0cyA9IChudW0gKyAnJykuc3BsaXQoJycpLnJldmVyc2UoKTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGRpZ2l0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBkaWdpdCA9IGRpZ2l0c1tpXTtcbiAgICAgICAgZGlnaXQgPSBwYXJzZUludChkaWdpdCwgMTApO1xuICAgICAgICBpZiAoKG9kZCA9ICFvZGQpKSB7XG4gICAgICAgICAgZGlnaXQgKj0gMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGlnaXQgPiA5KSB7XG4gICAgICAgICAgZGlnaXQgLT0gOTtcbiAgICAgICAgfVxuICAgICAgICBzdW0gKz0gZGlnaXQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3VtICUgMTAgPT09IDA7XG4gICAgfTtcbiAgICBoYXNUZXh0U2VsZWN0ZWQgPSBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgIHZhciByZWY7XG4gICAgICBpZiAoKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBkb2N1bWVudCAhPT0gbnVsbCA/IChyZWYgPSBkb2N1bWVudC5zZWxlY3Rpb24pICE9IG51bGwgPyByZWYuY3JlYXRlUmFuZ2UgOiB2b2lkIDAgOiB2b2lkIDApICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLnRleHQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuICh0YXJnZXQuc2VsZWN0aW9uU3RhcnQgIT0gbnVsbCkgJiYgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0ICE9PSB0YXJnZXQuc2VsZWN0aW9uRW5kO1xuICAgIH07XG4gICAgcmVwbGFjZUZ1bGxXaWR0aENoYXJzID0gZnVuY3Rpb24oc3RyKSB7XG4gICAgICB2YXIgY2hhciwgY2hhcnMsIGZ1bGxXaWR0aCwgaGFsZldpZHRoLCBpLCBpZHgsIGxlbiwgdmFsdWU7XG4gICAgICBpZiAoc3RyID09IG51bGwpIHtcbiAgICAgICAgc3RyID0gJyc7XG4gICAgICB9XG4gICAgICBmdWxsV2lkdGggPSAnXFx1ZmYxMFxcdWZmMTFcXHVmZjEyXFx1ZmYxM1xcdWZmMTRcXHVmZjE1XFx1ZmYxNlxcdWZmMTdcXHVmZjE4XFx1ZmYxOSc7XG4gICAgICBoYWxmV2lkdGggPSAnMDEyMzQ1Njc4OSc7XG4gICAgICB2YWx1ZSA9ICcnO1xuICAgICAgY2hhcnMgPSBzdHIuc3BsaXQoJycpO1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gY2hhcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2hhciA9IGNoYXJzW2ldO1xuICAgICAgICBpZHggPSBmdWxsV2lkdGguaW5kZXhPZihjaGFyKTtcbiAgICAgICAgaWYgKGlkeCA+IC0xKSB7XG4gICAgICAgICAgY2hhciA9IGhhbGZXaWR0aFtpZHhdO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlICs9IGNoYXI7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICByZUZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yO1xuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGUudGFyZ2V0LnZhbHVlID0gcGF5Zm9ybS5mb3JtYXRDYXJkTnVtYmVyKGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgIGlmICgoY3Vyc29yICE9IG51bGwpICYmIGUudHlwZSAhPT0gJ2NoYW5nZScpIHtcbiAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGN1cnNvciwgY3Vyc29yKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY2FyZCwgY3Vyc29yLCBkaWdpdCwgbGVuZ3RoLCByZSwgdXBwZXJMZW5ndGgsIHZhbHVlO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKHZhbHVlICsgZGlnaXQpO1xuICAgICAgbGVuZ3RoID0gKHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJykgKyBkaWdpdCkubGVuZ3RoO1xuICAgICAgdXBwZXJMZW5ndGggPSAxNjtcbiAgICAgIGlmIChjYXJkKSB7XG4gICAgICAgIHVwcGVyTGVuZ3RoID0gY2FyZC5sZW5ndGhbY2FyZC5sZW5ndGgubGVuZ3RoIC0gMV07XG4gICAgICB9XG4gICAgICBpZiAobGVuZ3RoID49IHVwcGVyTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBpZiAoY3Vyc29yICYmIGN1cnNvciAhPT0gdmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJkICYmIGNhcmQudHlwZSA9PT0gJ2FtZXgnKSB7XG4gICAgICAgIHJlID0gL14oXFxkezR9fFxcZHs0fVxcc1xcZHs2fSkkLztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlID0gLyg/Ol58XFxzKShcXGR7NH0pJC87XG4gICAgICB9XG4gICAgICBpZiAocmUudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWx1ZSArIFwiIFwiICsgZGlnaXQ7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChyZS50ZXN0KHZhbHVlICsgZGlnaXQpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gKHZhbHVlICsgZGlnaXQpICsgXCIgXCI7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9ybWF0QmFja0NhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yLCB2YWx1ZTtcbiAgICAgIHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICBpZiAoZS53aGljaCAhPT0gOCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjdXJzb3IgPSBfZ2V0Q2FyZXRQb3MoZS50YXJnZXQpO1xuICAgICAgaWYgKGN1cnNvciAmJiBjdXJzb3IgIT09IHZhbHVlLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoL1xcZFxccyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxkXFxzJC8sICcnKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKC9cXHNcXGQ/JC8udGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXGQkLywgJycpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJlRm9ybWF0RXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvcjtcbiAgICAgIGN1cnNvciA9IF9nZXRDYXJldFBvcyhlLnRhcmdldCk7XG4gICAgICBlLnRhcmdldC52YWx1ZSA9IHBheWZvcm0uZm9ybWF0Q2FyZEV4cGlyeShlLnRhcmdldC52YWx1ZSk7XG4gICAgICBpZiAoKGN1cnNvciAhPSBudWxsKSAmJiBlLnR5cGUgIT09ICdjaGFuZ2UnKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3IsIGN1cnNvcik7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRDYXJkRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGRpZ2l0LCB2YWw7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbCA9IGUudGFyZ2V0LnZhbHVlICsgZGlnaXQ7XG4gICAgICBpZiAoL15cXGQkLy50ZXN0KHZhbCkgJiYgKHZhbCAhPT0gJzAnICYmIHZhbCAhPT0gJzEnKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IFwiMFwiICsgdmFsICsgXCIgLyBcIjtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKC9eXFxkXFxkJC8udGVzdCh2YWwpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gdmFsICsgXCIgLyBcIjtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRGb3J3YXJkRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGRpZ2l0LCB2YWw7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKC9eXFxkXFxkJC8udGVzdCh2YWwpKSB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbCArIFwiIC8gXCI7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRGb3J3YXJkU2xhc2hBbmRTcGFjZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciB2YWwsIHdoaWNoO1xuICAgICAgd2hpY2ggPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEod2hpY2ggPT09ICcvJyB8fCB3aGljaCA9PT0gJyAnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWwgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgIGlmICgvXlxcZCQvLnRlc3QodmFsKSAmJiB2YWwgIT09ICcwJykge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQudmFsdWUgPSBcIjBcIiArIHZhbCArIFwiIC8gXCI7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3JtYXRCYWNrRXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGN1cnNvciwgdmFsdWU7XG4gICAgICB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKGUud2hpY2ggIT09IDgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGlmIChjdXJzb3IgJiYgY3Vyc29yICE9PSB2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKC9cXGRcXHNcXC9cXHMkLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC52YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xcZFxcc1xcL1xccyQvLCAnJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVGb3JtYXRDVkMgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY3Vyc29yO1xuICAgICAgY3Vyc29yID0gX2dldENhcmV0UG9zKGUudGFyZ2V0KTtcbiAgICAgIGUudGFyZ2V0LnZhbHVlID0gcmVwbGFjZUZ1bGxXaWR0aENoYXJzKGUudGFyZ2V0LnZhbHVlKS5yZXBsYWNlKC9cXEQvZywgJycpLnNsaWNlKDAsIDQpO1xuICAgICAgaWYgKChjdXJzb3IgIT0gbnVsbCkgJiYgZS50eXBlICE9PSAnY2hhbmdlJykge1xuICAgICAgICByZXR1cm4gZS50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yLCBjdXJzb3IpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVzdHJpY3ROdW1lcmljID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGlucHV0O1xuICAgICAgaWYgKGUubWV0YUtleSB8fCBlLmN0cmxLZXkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGUud2hpY2ggPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGUud2hpY2ggPCAzMykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpbnB1dCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgY2FyZCwgZGlnaXQsIHZhbHVlO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IChlLnRhcmdldC52YWx1ZSArIGRpZ2l0KS5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKHZhbHVlKTtcbiAgICAgIGlmIChjYXJkICYmIHZhbHVlLmxlbmd0aCA+IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdKSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9IGVsc2UgaWYgKHZhbHVlLmxlbmd0aCA+IDE2KSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdEV4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBkaWdpdCwgdmFsdWU7XG4gICAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQoZS50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbHVlID0gZS50YXJnZXQudmFsdWUgKyBkaWdpdDtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiA2KSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXN0cmljdENWQyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBkaWdpdCwgdmFsO1xuICAgICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWwgPSBlLnRhcmdldC52YWx1ZSArIGRpZ2l0O1xuICAgICAgaWYgKHZhbC5sZW5ndGggPiA0KSB7XG4gICAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBwYXlmb3JtLmN2Y0lucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3RDVkMpO1xuICAgICAgX29uKGlucHV0LCAncGFzdGUnLCByZUZvcm1hdENWQyk7XG4gICAgICBfb24oaW5wdXQsICdjaGFuZ2UnLCByZUZvcm1hdENWQyk7XG4gICAgICByZXR1cm4gX29uKGlucHV0LCAnaW5wdXQnLCByZUZvcm1hdENWQyk7XG4gICAgfTtcbiAgICBwYXlmb3JtLmV4cGlyeUlucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3RFeHBpcnkpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCBmb3JtYXRDYXJkRXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgZm9ybWF0Rm9yd2FyZFNsYXNoQW5kU3BhY2UpO1xuICAgICAgX29uKGlucHV0LCAna2V5cHJlc3MnLCBmb3JtYXRGb3J3YXJkRXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleWRvd24nLCBmb3JtYXRCYWNrRXhwaXJ5KTtcbiAgICAgIF9vbihpbnB1dCwgJ2NoYW5nZScsIHJlRm9ybWF0RXhwaXJ5KTtcbiAgICAgIHJldHVybiBfb24oaW5wdXQsICdpbnB1dCcsIHJlRm9ybWF0RXhwaXJ5KTtcbiAgICB9O1xuICAgIHBheWZvcm0uY2FyZE51bWJlcklucHV0ID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgcmVzdHJpY3RDYXJkTnVtYmVyKTtcbiAgICAgIF9vbihpbnB1dCwgJ2tleXByZXNzJywgZm9ybWF0Q2FyZE51bWJlcik7XG4gICAgICBfb24oaW5wdXQsICdrZXlkb3duJywgZm9ybWF0QmFja0NhcmROdW1iZXIpO1xuICAgICAgX29uKGlucHV0LCAncGFzdGUnLCByZUZvcm1hdENhcmROdW1iZXIpO1xuICAgICAgX29uKGlucHV0LCAnY2hhbmdlJywgcmVGb3JtYXRDYXJkTnVtYmVyKTtcbiAgICAgIHJldHVybiBfb24oaW5wdXQsICdpbnB1dCcsIHJlRm9ybWF0Q2FyZE51bWJlcik7XG4gICAgfTtcbiAgICBwYXlmb3JtLm51bWVyaWNJbnB1dCA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICBfb24oaW5wdXQsICdrZXlwcmVzcycsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdwYXN0ZScsIHJlc3RyaWN0TnVtZXJpYyk7XG4gICAgICBfb24oaW5wdXQsICdjaGFuZ2UnLCByZXN0cmljdE51bWVyaWMpO1xuICAgICAgcmV0dXJuIF9vbihpbnB1dCwgJ2lucHV0JywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICB9O1xuICAgIHBheWZvcm0ucGFyc2VDYXJkRXhwaXJ5ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBtb250aCwgcHJlZml4LCByZWYsIHllYXI7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJyk7XG4gICAgICByZWYgPSB2YWx1ZS5zcGxpdCgnLycsIDIpLCBtb250aCA9IHJlZlswXSwgeWVhciA9IHJlZlsxXTtcbiAgICAgIGlmICgoeWVhciAhPSBudWxsID8geWVhci5sZW5ndGggOiB2b2lkIDApID09PSAyICYmIC9eXFxkKyQvLnRlc3QoeWVhcikpIHtcbiAgICAgICAgcHJlZml4ID0gKG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpO1xuICAgICAgICBwcmVmaXggPSBwcmVmaXgudG9TdHJpbmcoKS5zbGljZSgwLCAyKTtcbiAgICAgICAgeWVhciA9IHByZWZpeCArIHllYXI7XG4gICAgICB9XG4gICAgICBtb250aCA9IHBhcnNlSW50KG1vbnRoLCAxMCk7XG4gICAgICB5ZWFyID0gcGFyc2VJbnQoeWVhciwgMTApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbW9udGg6IG1vbnRoLFxuICAgICAgICB5ZWFyOiB5ZWFyXG4gICAgICB9O1xuICAgIH07XG4gICAgcGF5Zm9ybS52YWxpZGF0ZUNhcmROdW1iZXIgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgIHZhciBjYXJkLCByZWY7XG4gICAgICBudW0gPSAobnVtICsgJycpLnJlcGxhY2UoL1xccyt8LS9nLCAnJyk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QobnVtKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjYXJkID0gY2FyZEZyb21OdW1iZXIobnVtKTtcbiAgICAgIGlmICghY2FyZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gKHJlZiA9IG51bS5sZW5ndGgsIGluZGV4T2YuY2FsbChjYXJkLmxlbmd0aCwgcmVmKSA+PSAwKSAmJiAoY2FyZC5sdWhuID09PSBmYWxzZSB8fCBsdWhuQ2hlY2sobnVtKSk7XG4gICAgfTtcbiAgICBwYXlmb3JtLnZhbGlkYXRlQ2FyZEV4cGlyeSA9IGZ1bmN0aW9uKG1vbnRoLCB5ZWFyKSB7XG4gICAgICB2YXIgY3VycmVudFRpbWUsIGV4cGlyeSwgcmVmO1xuICAgICAgaWYgKHR5cGVvZiBtb250aCA9PT0gJ29iamVjdCcgJiYgJ21vbnRoJyBpbiBtb250aCkge1xuICAgICAgICByZWYgPSBtb250aCwgbW9udGggPSByZWYubW9udGgsIHllYXIgPSByZWYueWVhcjtcbiAgICAgIH1cbiAgICAgIGlmICghKG1vbnRoICYmIHllYXIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIG1vbnRoID0gU3RyaW5nKG1vbnRoKS50cmltKCk7XG4gICAgICB5ZWFyID0gU3RyaW5nKHllYXIpLnRyaW0oKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChtb250aCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KHllYXIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghKCgxIDw9IG1vbnRoICYmIG1vbnRoIDw9IDEyKSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKHllYXIubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGlmICh5ZWFyIDwgNzApIHtcbiAgICAgICAgICB5ZWFyID0gXCIyMFwiICsgeWVhcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB5ZWFyID0gXCIxOVwiICsgeWVhcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHllYXIubGVuZ3RoICE9PSA0KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGV4cGlyeSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoKTtcbiAgICAgIGN1cnJlbnRUaW1lID0gbmV3IERhdGU7XG4gICAgICBleHBpcnkuc2V0TW9udGgoZXhwaXJ5LmdldE1vbnRoKCkgLSAxKTtcbiAgICAgIGV4cGlyeS5zZXRNb250aChleHBpcnkuZ2V0TW9udGgoKSArIDEsIDEpO1xuICAgICAgcmV0dXJuIGV4cGlyeSA+IGN1cnJlbnRUaW1lO1xuICAgIH07XG4gICAgcGF5Zm9ybS52YWxpZGF0ZUNhcmRDVkMgPSBmdW5jdGlvbihjdmMsIHR5cGUpIHtcbiAgICAgIHZhciBjYXJkLCByZWY7XG4gICAgICBjdmMgPSBTdHJpbmcoY3ZjKS50cmltKCk7XG4gICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoY3ZjKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjYXJkID0gY2FyZEZyb21UeXBlKHR5cGUpO1xuICAgICAgaWYgKGNhcmQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gcmVmID0gY3ZjLmxlbmd0aCwgaW5kZXhPZi5jYWxsKGNhcmQuY3ZjTGVuZ3RoLCByZWYpID49IDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY3ZjLmxlbmd0aCA+PSAzICYmIGN2Yy5sZW5ndGggPD0gNDtcbiAgICAgIH1cbiAgICB9O1xuICAgIHBheWZvcm0ucGFyc2VDYXJkVHlwZSA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgdmFyIHJlZjtcbiAgICAgIGlmICghbnVtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuICgocmVmID0gY2FyZEZyb21OdW1iZXIobnVtKSkgIT0gbnVsbCA/IHJlZi50eXBlIDogdm9pZCAwKSB8fCBudWxsO1xuICAgIH07XG4gICAgcGF5Zm9ybS5mb3JtYXRDYXJkTnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICB2YXIgY2FyZCwgZ3JvdXBzLCByZWYsIHVwcGVyTGVuZ3RoO1xuICAgICAgbnVtID0gcmVwbGFjZUZ1bGxXaWR0aENoYXJzKG51bSk7XG4gICAgICBudW0gPSBudW0ucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcihudW0pO1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHJldHVybiBudW07XG4gICAgICB9XG4gICAgICB1cHBlckxlbmd0aCA9IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdO1xuICAgICAgbnVtID0gbnVtLnNsaWNlKDAsIHVwcGVyTGVuZ3RoKTtcbiAgICAgIGlmIChjYXJkLmZvcm1hdC5nbG9iYWwpIHtcbiAgICAgICAgcmV0dXJuIChyZWYgPSBudW0ubWF0Y2goY2FyZC5mb3JtYXQpKSAhPSBudWxsID8gcmVmLmpvaW4oJyAnKSA6IHZvaWQgMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdyb3VwcyA9IGNhcmQuZm9ybWF0LmV4ZWMobnVtKTtcbiAgICAgICAgaWYgKGdyb3VwcyA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGdyb3Vwcy5zaGlmdCgpO1xuICAgICAgICBncm91cHMgPSBncm91cHMuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICByZXR1cm4gZ3JvdXBzLmpvaW4oJyAnKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHBheWZvcm0uZm9ybWF0Q2FyZEV4cGlyeSA9IGZ1bmN0aW9uKGV4cGlyeSkge1xuICAgICAgdmFyIG1vbiwgcGFydHMsIHNlcCwgeWVhcjtcbiAgICAgIGV4cGlyeSA9IHJlcGxhY2VGdWxsV2lkdGhDaGFycyhleHBpcnkpO1xuICAgICAgcGFydHMgPSBleHBpcnkubWF0Y2goL15cXEQqKFxcZHsxLDJ9KShcXEQrKT8oXFxkezEsNH0pPy8pO1xuICAgICAgaWYgKCFwYXJ0cykge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgICBtb24gPSBwYXJ0c1sxXSB8fCAnJztcbiAgICAgIHNlcCA9IHBhcnRzWzJdIHx8ICcnO1xuICAgICAgeWVhciA9IHBhcnRzWzNdIHx8ICcnO1xuICAgICAgaWYgKHllYXIubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXAgPSAnIC8gJztcbiAgICAgIH0gZWxzZSBpZiAoc2VwID09PSAnIC8nKSB7XG4gICAgICAgIG1vbiA9IG1vbi5zdWJzdHJpbmcoMCwgMSk7XG4gICAgICAgIHNlcCA9ICcnO1xuICAgICAgfSBlbHNlIGlmIChtb24ubGVuZ3RoID09PSAyIHx8IHNlcC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNlcCA9ICcgLyAnO1xuICAgICAgfSBlbHNlIGlmIChtb24ubGVuZ3RoID09PSAxICYmIChtb24gIT09ICcwJyAmJiBtb24gIT09ICcxJykpIHtcbiAgICAgICAgbW9uID0gXCIwXCIgKyBtb247XG4gICAgICAgIHNlcCA9ICcgLyAnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1vbiArIHNlcCArIHllYXI7XG4gICAgfTtcbiAgICByZXR1cm4gcGF5Zm9ybTtcbiAgfSk7XG5cbn0pLmNhbGwodGhpcyk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAvVXNlcnMvYm9iYnkvU2l0ZXMvaGVscGluZ2hhbmRzL2h0ZG9jcy93cC1jb250ZW50L3RoZW1lcy9oZWxwaW5naGFuZHMvdmVuZG9yL2RldmVsb3B3aXRod3Avb21nLWZvcm1zLWF1dGhvcml6ZS1uZXQvbm9kZV9tb2R1bGVzL3BheWZvcm0vZGlzdC9wYXlmb3JtLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdGlmKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdHRocm93IG5ldyBFcnJvcihcImRlZmluZSBjYW5ub3QgYmUgdXNlZCBpbmRpcmVjdFwiKTtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gKHdlYnBhY2spL2J1aWxkaW4vYW1kLWRlZmluZS5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9